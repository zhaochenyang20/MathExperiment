


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Building from source on Windows &#8212; SciPy v1.10.0 Manual</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/scipy.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="../../_static/versioncheck.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <script defer data-domain="docs.scipy.org" src="https://views.scientific-python.org/js/script.js"></script>
    
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    <img src="../../_static/logo.svg" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/logo.svg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../tutorial/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../reference/index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../release.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        1.10.0  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables dev/contributor/windows and {'json_url': 'https://scipy.github.io/devdocs/_static/version_switcher.json', 'version_match': '1.10.0'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "dev/contributor/windows.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://scipy.github.io/devdocs/_static/version_switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "dev/contributor/windows.html";
        let btn = document.getElementById("version_switcher_button");
        // Set empty strings by default so that these attributes exist and can be used in CSS selectors
        btn.dataset["activeVersionName"] = "";
        btn.dataset["activeVersion"] = "";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 1.10.0 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "1.10.0") {
                node.classList.add("active");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/scipy/scipy" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/SciPy_team" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#building-the-released-scipy">
   Building the Released SciPy
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-openblas">
     Building OpenBLAS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#installing-openblas">
     Installing OpenBLAS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-scipy">
     Building SciPy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#building-against-an-older-numpy-version">
   Building Against an Older NumPy Version
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-resources">
   Additional Resources
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="building-from-source-on-windows">
<span id="build-windows"></span><h1>Building from source on Windows<a class="headerlink" href="#building-from-source-on-windows" title="Permalink to this heading">#</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id2">Overview</a></p></li>
<li><p><a class="reference internal" href="#building-the-released-scipy" id="id3">Building the Released SciPy</a></p>
<ul>
<li><p><a class="reference internal" href="#building-openblas" id="id4">Building OpenBLAS</a></p></li>
<li><p><a class="reference internal" href="#installing-openblas" id="id5">Installing OpenBLAS</a></p></li>
<li><p><a class="reference internal" href="#building-scipy" id="id6">Building SciPy</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#building-against-an-older-numpy-version" id="id7">Building Against an Older NumPy Version</a></p></li>
<li><p><a class="reference internal" href="#additional-resources" id="id8">Additional Resources</a></p></li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>Compared to OSX and Linux, building NumPy and SciPy on Windows is more
difficult, largely due to the lack of compatible, open-source libraries like
BLAS/<a class="reference external" href="http://www.netlib.org/lapack/">LAPACK</a> and open-source compilers that are necessary to build both
libraries and have them perform relatively well. It is not possible to just
call a one-liner on the command prompt as you would on other platforms via
<code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt</span> <span class="pre">install</span></code> machinery.</p>
<p>This document describes one option to build OpenBLAS and SciPy from source
that was validated for SciPy 1.6.0. However, in light of all the work
currently being done, please <strong>do not expect</strong> these instructions to be
accurate in the long-run and be sure to check up on any of the open source
projects mentioned for the most up-to-date information. For more information
on all of these projects, the <a class="reference external" href="https://mingwpy.github.io/">Mingwpy</a> website is an excellent source of
in-depth information than this document will provide.</p>
</section>
<section id="building-the-released-scipy">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Building the Released SciPy</a><a class="headerlink" href="#building-the-released-scipy" title="Permalink to this heading">#</a></h2>
<p>This section provides the step-by-step process to build the released SciPy.
If you want to build completely from source, you should estimate at least
three hours to build all libraries and compile SciPy. Feel free to stop and
inspect any step at any time, but for this section, we’ll just mention the
steps without providing an in-depth explanation for the reasons behind them.
If you have further questions about what we’re doing, more in-depth
documentation is provided in the sections below. Also, please make sure to
read this section before proceeding, as the presence or absence of error
messages in general is not a good indication of whether you’ve completed a
step correctly. Each step creates particular files, and what ultimately
matters is whether you have built the required files rather than whether
error messages appeared in your terminal.</p>
<section id="building-openblas">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Building OpenBLAS</a><a class="headerlink" href="#building-openblas" title="Permalink to this heading">#</a></h3>
<p>First, we need to install the software required to build <a class="reference external" href="https://github.com/xianyi/OpenBLAS">OpenBLAS</a>, which is
the <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms">BLAS</a> library that we’re going to use. Because the software to build
OpenBLAS is different than that required to build SciPy and because OpenBLAS
takes a long time to build, we’re going to start building OpenBLAS first and
then explain what to do next while the OpenBLAS build is running.
<strong>Alternatively, if you’d rather download a pre-built OpenBLAS, download the
one of the</strong> <a class="reference external" href="https://3f23b170c54c2533c070-1c8a9b3114517dc5fe17b7c3f8c63a43.ssl.cf2.rackcdn.com/">pre-built zip files</a> <strong>and skip to the Installing OpenBLAS
section below.</strong>. However it is also likely that your version of Windows and
the compiler you wish to use won’t be compatible with what these prebuilt
binaries produced. This is still one of the main pain points of building
for Windows. That’s why we will attempt to build our own OpenBLAS.</p>
<p>We start by installing the MSYS2 platform, on which the OpenBLAS build will take
place. First, download the MSYS2 installer from <a class="reference external" href="https://www.msys2.org/">msysintaller</a> via choosing
32 or 64 bit. Make sure to install the correct architecture for the SciPy
that you want to build (e.g., 32 or 64 bit). If you are not sure which one to use,
proceed with 64bit. Please follow the installation instructions carefully,
especially step 6 and 7 to update all components.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Occasionally,
during the updates, the terminal might ask you to close the terminal but then
might refuse to be closed and hang. If this happens, you can kill it via Task
Manager and continue with the instructions.</p>
</div>
<p>Now, the next step is to install some more package bundles that we will need. Open
a MSYS2 <strong>MinGW</strong> (64 or 32 bit) terminal and type the following depending on the
architecture of your choice; run the following for the common 64-bit build</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pacman<span class="w"> </span>-S<span class="w"> </span>--needed<span class="w"> </span>base-devel<span class="w"> </span>mingw-w64-x86_64-toolchain<span class="w"> </span>mingw-w64-x86_64-cmake<span class="w"> </span>git
</pre></div>
</div>
<p>and for 32-bit run instead</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pacman<span class="w"> </span>-S<span class="w"> </span>--needed<span class="w"> </span>base-devel<span class="w"> </span>mingw-w64-i686-toolchain<span class="w"> </span>mingw-w64-i686-cmake<span class="w"> </span>git
</pre></div>
</div>
<p>Again, if you are not sure which one you want, choose 64-bit option in every
step.</p>
<p>It will prompt to whether install everything in these packages and you can
simply accept all via hitting enter key at each step which also takes some time
to complete. Once you install everything, close and
reopen the MSYS2 MinGW terminal.</p>
<p>If you already have a GitHub repository folder where you keep your own repos,
it is better to use that location to keep things nice and tidy since we are
going to clone yet another repository to obtain the source code. It should be
somewhere convenient and with write permissions. If this is your first time then
you can pick “DocumentsGitHub” as a viable option. We will assume that you
picked this folder in the rest of this document. You can create a folder in “My
Documents” using Windows Explorer. To make sure that we’re ready to build, type
the following in the terminal one-by-one:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>make
gfortran
gcc
git
</pre></div>
</div>
<p>Each of these commands should fail as we have not provided any arguments
to them. However, an explicit failure from the program rather than from
the command prompt implies that the program is accessible on the path,
which is what we wanted to test. In turn, if an error about the command being
not found is returned, then installation of the packages didn’t complete
successfully. If any of these are missing, you’re not ready to build. Go back
and make sure that MSYS2 is installed correctly and has the required packages
enabled.</p>
<p>Now it’s time to clone the OpenBLAS repository somewhere convenient. Run the
following line-by-line separately, modifying the path to your GitHub repo
folder as appropriate.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\&lt;</span>user<span class="w"> </span>name&gt;<span class="se">\D</span>ocuments<span class="se">\G</span>itHub
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/xianyi/OpenBLAS.git
<span class="nb">cd</span><span class="w"> </span>OpenBLAS
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init<span class="w"> </span>--recursive
git<span class="w"> </span>fetch<span class="w"> </span>--all<span class="w"> </span>--tags<span class="w"> </span>--prune
</pre></div>
</div>
<p>Now we are going to switch to a release of our choice. At the time of writing,
the newest OpenBLAS release version is 0.3.7, hence we will use that.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>tags/v0.3.7<span class="w"> </span>-b<span class="w"> </span>v0.3.7
</pre></div>
</div>
<p>You can see all available options via</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>tag
</pre></div>
</div>
<p>Now change the directory one level up via <code class="code docutils literal notranslate"><span class="pre">cd</span> <span class="pre">..</span></code> to get out of the
directory and create a file named <em class="xref py py-obj">build_openblas.sh</em>. The easiest way is to
type</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>touch<span class="w"> </span>build_openblas.sh
</pre></div>
</div>
<p>Of course, you can still also use Windows Explorer to create a new txt file at
that location and then rename it. So the resulting structure would be</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>my<span class="w"> </span>repo<span class="w"> </span>folder
<span class="w">    </span>├───<span class="w"> </span>build_openblas.sh
<span class="w">    </span>├───<span class="w"> </span>OpenBLAS
<span class="w">            </span>├───<span class="w"> </span>...
</pre></div>
</div>
<p>Then open this file in any text editor, like Notepad++, and paste the following
content in this empty file:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># You may adjust to your preferred output directory</span>
<span class="nv">OPENBLAS_ROOT</span><span class="o">=</span>/c/opt

<span class="c1"># Adjust to match the MSYS2 version you installed</span>
<span class="nv">BUILD_BITS</span><span class="o">=</span><span class="m">64</span>

<span class="c1"># Print some gcc info that MSYS2 discovered in the path</span>
which<span class="w"> </span>gcc
gcc<span class="w"> </span>--version

<span class="c1"># Get into the repository that we cloned</span>
<span class="nb">cd</span><span class="w"> </span>OpenBLAS

<span class="c1"># The following two lines clean up in case we make a mistake and need</span>
<span class="c1"># to run the script again</span>
git<span class="w"> </span>clean<span class="w"> </span>-fxd
git<span class="w"> </span>reset<span class="w"> </span>--hard
rm<span class="w"> </span>-rf<span class="w"> </span><span class="nv">$OPENBLAS_ROOT</span>/<span class="nv">$BUILD_BITS</span>

<span class="c1"># Set architecture flags</span>
<span class="nv">march</span><span class="o">=</span><span class="s2">&quot;x86-64&quot;</span>
<span class="nv">extra</span><span class="o">=</span><span class="s2">&quot;-fno-asynchronous-unwind-tables&quot;</span>
<span class="nv">vc_arch</span><span class="o">=</span><span class="s2">&quot;X64&quot;</span>
<span class="nv">cflags</span><span class="o">=</span><span class="s2">&quot;-O2 -march=</span><span class="nv">$march</span><span class="s2"> -mtune=generic </span><span class="nv">$extra</span><span class="s2">&quot;</span>
<span class="nv">fflags</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$cflags</span><span class="s2"> -frecursive -ffpe-summary=invalid,zero&quot;</span>

<span class="c1"># Build name for output library from gcc version and OpenBLAS commit.</span>
<span class="nv">GCC_TAG</span><span class="o">=</span><span class="s2">&quot;gcc_</span><span class="k">$(</span>gcc<span class="w"> </span>-dumpversion<span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>.-<span class="w"> </span>_<span class="k">)</span><span class="s2">&quot;</span>
<span class="nv">OPENBLAS_VERSION</span><span class="o">=</span><span class="k">$(</span>git<span class="w"> </span>describe<span class="w"> </span>--tags<span class="k">)</span>
<span class="c1"># Build OpenBLAS</span>
<span class="c1"># Variable used in creating output libraries</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">LIBNAMESUFFIX</span><span class="o">=</span><span class="si">${</span><span class="nv">OPENBLAS_VERSION</span><span class="si">}</span>-<span class="si">${</span><span class="nv">GCC_TAG</span><span class="si">}</span>
make<span class="w"> </span><span class="nv">BINARY</span><span class="o">=</span><span class="nv">$BUILD_BITS</span><span class="w"> </span><span class="nv">DYNAMIC_ARCH</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">USE_THREAD</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">USE_OPENMP</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">NO_WARMUP</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">BUILD_LAPACK_DEPRECATED</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">COMMON_OPT</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$cflags</span><span class="s2">&quot;</span><span class="w"> </span><span class="nv">FCOMMON_OPT</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$fflags</span><span class="s2">&quot;</span>
make<span class="w"> </span>install<span class="w"> </span><span class="nv">PREFIX</span><span class="o">=</span><span class="nv">$OPENBLAS_ROOT</span>/<span class="nv">$BUILD_BITS</span>
</pre></div>
</div>
<p>This is the automation script that will make sure the right variables are used
in the right place. Linux users are very familiar to such scripts, but for
Windows users it might be a bit awkward. You can think of these as <code class="docutils literal notranslate"><span class="pre">.bat</span></code>
files. The script should work as-in for MSYS2 64-bit, but you can change the
variables to your situation as needed. After you’ve created
this file and you are one directory up the OpenBLAS repo of that, start the
OpenBLAS build with:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>./build_openblas.sh
</pre></div>
</div>
<p>Building OpenBLAS is challenging and time-consuming. The build may fail with an
error after a few hours but may also fail silently and produce an incorrect
binary. Please, if you have any issues, <a class="reference external" href="https://github.com/scipy/scipy/issues/new">report them</a> so that we can save the
next person’s time.</p>
<p>One of the known issues is the following; if you, by any chance, receive the
following error</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&lt;command-line&gt;:0:4:<span class="w"> </span>error:<span class="w"> </span>expected<span class="w"> </span>identifier<span class="w"> </span>or<span class="w"> </span><span class="s1">&#39;(&#39;</span><span class="w"> </span>before<span class="w"> </span>numeric<span class="w"> </span>constant
</pre></div>
</div>
<p>that means you have some header file definition clash and you have to downgrade
certain items. This is not related to SciPy but let’s attempt to provide a
solution. See this
<a class="reference external" href="https://github.com/xianyi/OpenBLAS/wiki/How-to-use-OpenBLAS-in-Microsoft-Visual-Studio#build-openblas-on-windows-os">OpenBLASwiki</a>
page to read on which packages to downgrade and how to do it.
Basically, it involves downloading three files. Then in the MSYS terminal
change the directory to the place where you downloaded the files and run the
commands given in the wiki link. Then come back to the script directory where
<em class="xref py py-obj">/build_openblas.sh</em> lives and try again. This should be sufficient for you to
build OpenBLAS.</p>
<p>While you’re waiting on OpenBLAS to finish building, go ahead and install
<a class="reference external" href="https://www.visualstudio.com/downloads/#build-tools-for-visual-studio-2017">build tools</a> from Microsoft, since these take a while to install and you’ll
need them later.</p>
<p>After the <code class="code docutils literal notranslate"><span class="pre">build_openblas.sh</span></code> script has completed, there should be an
<code class="code docutils literal notranslate"><span class="pre">libopenblas.....a</span></code> as a resulting artifact. If <code class="code docutils literal notranslate"><span class="pre">OPENBLAS_ROOT</span></code> was
set to <code class="code docutils literal notranslate"><span class="pre">C:\opt</span></code>, then you might see a line like this in the MSYS2
terminal:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Copying<span class="w"> </span>the<span class="w"> </span>static<span class="w"> </span>library<span class="w"> </span>to<span class="w"> </span>/c/opt/64/lib
</pre></div>
</div>
<p>This is very good news: you have successfully built OpenBLAS!</p>
</section>
<section id="installing-openblas">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Installing OpenBLAS</a><a class="headerlink" href="#installing-openblas" title="Permalink to this heading">#</a></h3>
<p>Look for the <code class="docutils literal notranslate"><span class="pre">lib</span></code> folder in the folder you used as a parameter to
<code class="code docutils literal notranslate"><span class="pre">OPENBLAS_ROOT</span></code>. (It’s <code class="docutils literal notranslate"><span class="pre">/c/opt/64/lib</span></code> if you didn’t change anything in
the script.) You will find three <code class="docutils literal notranslate"><span class="pre">.a</span></code> files such as (the names can differ):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>libopenblas_v0.2.20-2-g5f998efd-gcc_9_2_0.a
libopenblas_v0.2.20-2-g5f998efd-gcc_9_2_0.dll.a
libopenblas_v0.2.20-2-g5f998efd-gcc_9_2_0.p-r0.2.20.a
</pre></div>
</div>
<p>From these three we are interested only in the first one. Just make a copy and
rename it to <code class="code docutils literal notranslate"><span class="pre">openblas.a</span></code>.</p>
<p>If you don’t have that file, you’ll probably need to find
out what happened and then build OpenBLAS again. We know this is <strong>very</strong>
annoying, but unfortunately we have no other alternatives. The first place
to look for is inside the OpenBLAS directory. If the build succeeds but (for
some reason) auto-moving files to <code class="code docutils literal notranslate"><span class="pre">OPENBLAS_ROOT</span></code> fails, the artifacts
will stay inside the OpenBLAS repo
folder. But if you have that file, that’s great and we’ll assume that you’ve
completed this step correctly. Proceeding on that assumption, let’s build
SciPy.</p>
<p>Before continuing, make sure that you don’t have other copies of either
<code class="code docutils literal notranslate"><span class="pre">openblas.a</span></code> or <code class="code docutils literal notranslate"><span class="pre">libopenblas.a</span></code> from previous attempts or via
previous downloads. Multiple copies could result in later build errors that
will be difficult to debug. If this is the first attempt, you don’t need to
worry about this step.</p>
</section>
<section id="building-scipy">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Building SciPy</a><a class="headerlink" href="#building-scipy" title="Permalink to this heading">#</a></h3>
<p>Once you have built OpenBLAS, it’s time to build SciPy. Before continuing, make
sure to install the following software for building on the latest Python
version. For building on other Python versions, see the <a class="reference external" href="https://wiki.python.org/moin/WindowsCompilers">WindowsCompilers</a> page.
We are also assuming that your Python is on the system path. That is to say,
when you type <em class="xref py py-obj">python</em> in the Windows command prompt the correct Python is
executed.</p>
<p>Install Microsoft Visual Studio 2017 or 2019 Community Edition (use the
<a class="reference external" href="https://www.visualstudio.com/downloads/#build-tools-for-visual-studio-2017">build tools</a> from Microsoft). If you feel that it is too bloated to install
everything in that bundle (which we do feel a bit so) then here are a subset
which are tested during the build of SciPy 1.6.0 and VS 2019. You can switch
to the individual items view at the top and select only the following</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C++<span class="w"> </span>Core<span class="w"> </span>Features
Windows<span class="w"> </span>Universal<span class="w"> </span>C<span class="w"> </span>Runtime
MSVC<span class="w"> </span>v142<span class="w"> </span>-<span class="w"> </span>VS<span class="w"> </span><span class="m">2019</span><span class="w"> </span>C++<span class="w"> </span>x64/x86<span class="w"> </span>build<span class="w"> </span>tools<span class="w"> </span><span class="o">(</span>...<span class="o">)</span>
Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>SDK<span class="w"> </span><span class="o">(</span><span class="m">10</span>.0.18362.0<span class="o">)</span>
C++<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Redistributable<span class="w"> </span>Update
C++<span class="w"> </span>Clang-cl<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">142</span><span class="w"> </span>build<span class="w"> </span>tools<span class="w"> </span><span class="o">(</span>x64/x86<span class="o">)</span>
C++<span class="w"> </span>Clang<span class="w"> </span>Compiler<span class="w"> </span><span class="k">for</span><span class="w"> </span>Windows<span class="w"> </span><span class="o">(</span><span class="m">8</span>.0.1<span class="o">)</span>
</pre></div>
</div>
<p>Just like before, pick a convenient place to
clone SciPy. Next to OpenBLAS is often a convenient option (note: not inside
OpenBLAS folder but next to). Continuing the example from above</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>my<span class="w"> </span>repo<span class="w"> </span>folder
<span class="w">    </span>├───<span class="w"> </span>build_openblas.sh
<span class="w">    </span>├───<span class="w"> </span>OpenBLAS
<span class="w">    </span>├───<span class="w"> </span>SciPy
<span class="w">            </span>├───<span class="w"> </span>...
</pre></div>
</div>
<p>Again using the same generic example folder from above</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\&lt;</span>user<span class="w"> </span>name&gt;<span class="se">\D</span>ocuments<span class="se">\G</span>itHub
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/scipy/scipy.git
<span class="nb">cd</span><span class="w"> </span>scipy
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init
</pre></div>
</div>
<p>Now we need to copy the <code class="code docutils literal notranslate"><span class="pre">openblas.a</span></code> file that we’ve built earlier to the
correct location. If your Python is installed somewhere like the following:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C:<span class="se">\U</span>sers<span class="se">\&lt;</span>user<span class="w"> </span>name&gt;<span class="se">\A</span>ppData<span class="se">\L</span>ocal<span class="se">\P</span>rograms<span class="se">\P</span>ython<span class="se">\P</span>ython38<span class="se">\p</span>ython.exe
</pre></div>
</div>
<p>then you’ll need to put the <code class="code docutils literal notranslate"><span class="pre">openblas.a</span></code> file that we previously copied
and renamed somewhere like the following:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C:<span class="se">\U</span>sers<span class="se">\&lt;</span>user<span class="w"> </span>name&gt;<span class="se">\A</span>ppData<span class="se">\L</span>ocal<span class="se">\P</span>rograms<span class="se">\P</span>ython<span class="se">\P</span>ython38<span class="se">\L</span>ib
</pre></div>
</div>
<p>Adjust the location accordingly based on where <code class="code docutils literal notranslate"><span class="pre">python.exe</span></code> is located.</p>
<p>At this stage, we are done with the OpenBLAS part and hopefully we will not need
to build OpenBLAS anytime soon. But we tend to build SciPy more often as it is
on a quicker release cycle. Hence it makes sense to use Windows <code class="docutils literal notranslate"><span class="pre">cmd</span></code> or
Powershell for the the build as it is a more native tool. This requires placing
the MinGW compilers on the path.  Hence, make sure that the following
folder (or the folder you have installed MSYS to) is on the system path
variable sufficiently close to the top.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C:<span class="se">\M</span>SYS64<span class="se">\M</span>INGW64<span class="se">\B</span>IN
</pre></div>
</div>
<p>For a sanity check, restart <code class="docutils literal notranslate"><span class="pre">cmd</span></code> or Powershell and type:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>gfortran
</pre></div>
</div>
<p>If you see a missing command error with the above, <code class="code docutils literal notranslate"><span class="pre">gfortran</span></code> is not
correctly installed or is still not on the path. However, we assume that it is now
on the path and accessible.</p>
<p>Now install the dependencies that we need to build and test SciPy.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>wheel<span class="w"> </span>setuptools<span class="w"> </span>numpy<span class="w"> </span>Cython<span class="w"> </span>pybind11<span class="w"> </span>pythran<span class="w"> </span>pytest<span class="w"> </span>pytest-xdist
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These instructions use <code class="docutils literal notranslate"><span class="pre">pip</span></code> as the package manager. You can also use <code class="docutils literal notranslate"><span class="pre">conda</span></code>
according to the instructions in the <a class="reference internal" href="conda_guide.html#conda-guide"><span class="std std-ref">Development environment guide (conda)</span></a> with minimal modifications
(e.g. you don’t need to install <code class="docutils literal notranslate"><span class="pre">gfortran</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span></code> because you already have them).</p>
</div>
<p>The last two are for using SciPy’s test suite, which is handy if you want to test
some new change locally.</p>
<p>Please note that this is a simpler procedure than what is used for the official
binaries. <strong>Your binaries will only work with the latest NumPy</strong>.
For building against older NumPy versions, see
<a class="reference internal" href="#building-against-an-older-numpy-version">Building Against an Older NumPy Version</a>.</p>
<p>Assuming that you are in the top of the SciPy repository directory where
<code class="docutils literal notranslate"><span class="pre">setup.py</span></code> is and assuming that you have set up everything correctly, you
are ready to build. Run the following commands:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>setup.py<span class="w"> </span>build
</pre></div>
</div>
<p>You may verify that the OpenBLAS library was correctly picked up by looking for
the following in your build log:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>FOUND:
<span class="w">   </span><span class="nv">libraries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;openblas&#39;</span><span class="o">]</span>
<span class="w">   </span><span class="nv">library_dirs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;C:\...........\lib&#39;</span><span class="o">]</span>
<span class="w">   </span><span class="nv">language</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>f77
<span class="w">   </span><span class="nv">define_macros</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[(</span><span class="s1">&#39;HAVE_CBLAS&#39;</span>,<span class="w"> </span>None<span class="o">)]</span>
</pre></div>
</div>
<p>Notice that there will be multiple lines similar to these. You only need to
track the OpenBLAS one.</p>
<p>When everything finishes without an error, congratulations! You’ve built
SciPy!</p>
<p>You can further install the built SciPy via</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>setup.py<span class="w"> </span>install
</pre></div>
</div>
<p>Just make sure that you uninstalled the existing installation of other SciPy if
there were any (by the regular <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">uninstall</span> <span class="pre">scipy</span></code> machinery).</p>
</section>
</section>
<section id="building-against-an-older-numpy-version">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Building Against an Older NumPy Version</a><a class="headerlink" href="#building-against-an-older-numpy-version" title="Permalink to this heading">#</a></h2>
<p>If you want to build SciPy to work with an older NumPy version, then you will need
to replace the NumPy “distutils” folder with the folder from the latest numpy.
The following Powershell snippet can upgrade NumPy distutils while retaining an older
NumPy <a class="reference external" href="https://en.wikipedia.org/wiki/Application_binary_interface">ABI</a>.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nv">$NumpyDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">$((</span>python<span class="w"> </span><span class="o">-</span>c<span class="w"> </span><span class="s1">&#39;import os; import numpy; print(os.path.dirname(numpy.__file__))&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span>Out-String<span class="o">)</span>.Trim<span class="o">()</span>
rm<span class="w"> </span><span class="o">-</span>r<span class="w"> </span><span class="o">-</span>Force<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$NumpyDir</span><span class="s2">\distutils&quot;</span>
<span class="nv">$tmpdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>New-TemporaryFile<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%{</span><span class="w"> </span>rm<span class="w"> </span><span class="nv">$_</span><span class="p">;</span><span class="w"> </span>mkdir<span class="w"> </span><span class="nv">$_</span><span class="w"> </span><span class="o">}</span>
git<span class="w"> </span>clone<span class="w"> </span><span class="o">-</span>q<span class="w"> </span><span class="o">--</span><span class="nv">depth</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="o">-</span>b<span class="w"> </span>master<span class="w"> </span>https://github.com/numpy/numpy.git<span class="w"> </span><span class="nv">$tmpdir</span>
mv<span class="w"> </span><span class="nv">$tmpdir</span><span class="se">\n</span>umpy<span class="se">\d</span>istutils<span class="w"> </span><span class="nv">$NumpyDir</span>
</pre></div>
</div>
</section>
<section id="additional-resources">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Additional Resources</a><a class="headerlink" href="#additional-resources" title="Permalink to this heading">#</a></h2>
<p>As discussed in the overview, this document is not meant to provide extremely detailed explanations on how to build
NumPy and SciPy on Windows. This is largely because currently, there is no single superior way to do so
and because the process for building these libraries on Windows is under development. It is likely that any
information will go out of date relatively soon. If you wish to receive more assistance, please reach out to the NumPy
and SciPy mailing lists, which can be found <a class="reference external" href="https://www.scipy.org/mailing-lists">here</a>.  There are many
developers out there working on this issue right now, and they would certainly be happy to help you out!  Google is also
a good resource, as there are many people out there who use NumPy and SciPy on Windows, so it would not be surprising if
your question or problem has already been addressed.</p>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2008-2023, The SciPy community.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>