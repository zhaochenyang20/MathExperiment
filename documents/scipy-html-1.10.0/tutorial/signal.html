


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Signal Processing (scipy.signal) &#8212; SciPy v1.10.0 Manual</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/scipy.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script src="../_static/versioncheck.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linear Algebra (scipy.linalg)" href="linalg.html" />
    <link rel="prev" title="Fourier Transforms (scipy.fft)" href="fft.html" />
    <script defer data-domain="docs.scipy.org" src="https://views.scientific-python.org/js/script.js"></script>
    
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    <img src="../_static/logo.svg" class="logo__image only-light" alt="Logo image">
    <img src="../_static/logo.svg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../getting_started.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../reference/index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../dev/index.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../release.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        1.10.0  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables tutorial/signal and {'json_url': 'https://scipy.github.io/devdocs/_static/version_switcher.json', 'version_match': '1.10.0'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "tutorial/signal.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://scipy.github.io/devdocs/_static/version_switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "tutorial/signal.html";
        let btn = document.getElementById("version_switcher_button");
        // Set empty strings by default so that these attributes exist and can be used in CSS selectors
        btn.dataset["activeVersionName"] = "";
        btn.dataset["activeVersion"] = "";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 1.10.0 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "1.10.0") {
                node.classList.add("active");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/scipy/scipy" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/SciPy_team" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="general.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="special.html">
   Special functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.special
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="integrate.html">
   Integration (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.integrate
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optimize.html">
   Optimization (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.optimize
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interpolate.html">
   Interpolation (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.interpolate
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fft.html">
   Fourier Transforms (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.fft
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Signal Processing (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.signal
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linalg.html">
   Linear Algebra (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.linalg
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arpack.html">
   Sparse eigenvalue problems with ARPACK
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="csgraph.html">
   Compressed Sparse Graph Routines (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.sparse.csgraph
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="spatial.html">
   Spatial data structures and algorithms (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.spatial
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats.html">
   Statistics (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.stats
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ndimage.html">
   Multidimensional image processing (
   <code class="xref py py-obj docutils literal notranslate">
    <span class="pre">
     scipy.ndimage
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="io.html">
   File IO (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.io
    </span>
   </code>
   )
  </a>
 </li>
</ul>

    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-splines">
   B-splines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filtering">
   Filtering
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convolution-correlation">
     Convolution/Correlation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#difference-equation-filtering">
     Difference-equation filtering
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-linear-systems">
       Analysis of Linear Systems
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filter-design">
     Filter Design
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fir-filter">
       FIR Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#iir-filter">
       IIR Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#filter-coefficients">
       Filter Coefficients
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#transfer-function-representation">
         Transfer function representation
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#zeros-and-poles-representation">
         Zeros and poles representation
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#state-space-system-representation">
         State-space system representation
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#second-order-sections-representation">
         Second-order sections representation
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#filter-transformations">
       Filter transformations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-filters">
     Other filters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#median-filter">
       Median Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#order-filter">
       Order Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#wiener-filter">
       Wiener filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#hilbert-filter">
       Hilbert filter
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analog-filter-design">
     Analog Filter Design
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spectral-analysis">
   Spectral Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#periodogram-measurements">
     Periodogram Measurements
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spectral-analysis-using-welch-s-method">
     Spectral Analysis using Welch’s Method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lomb-scargle-periodograms-lombscargle">
     Lomb-Scargle Periodograms (
     <code class="xref py py-func docutils literal notranslate">
      <span class="pre">
       lombscargle
      </span>
     </code>
     )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detrend">
   Detrend
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="signal-processing-scipy-signal">
<h1>Signal Processing (<a class="reference internal" href="../reference/signal.html#module-scipy.signal" title="scipy.signal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal</span></code></a>)<a class="headerlink" href="#signal-processing-scipy-signal" title="Permalink to this heading">#</a></h1>
<p>The signal processing toolbox currently contains some filtering
functions, a limited set of filter design tools, and a few B-spline
interpolation algorithms for 1- and 2-D data. While the
B-spline algorithms could technically be placed under the
interpolation category, they are included here because they only work
with equally-spaced data and make heavy use of filter-theory and
transfer-function formalism to provide a fast B-spline transform. To
understand this section, you will need to understand that a signal in
SciPy is an array of real or complex numbers.</p>
<section id="b-splines">
<span id="tutorial-signal-bsplines"></span><h2>B-splines<a class="headerlink" href="#b-splines" title="Permalink to this heading">#</a></h2>
<p>A B-spline is an approximation of a continuous function over a finite-
domain in terms of B-spline coefficients and knot points. If the knot-
points are equally spaced with spacing <span class="math notranslate nohighlight">\(\Delta x\)</span>, then the B-spline
approximation to a 1-D function is the finite-basis expansion.</p>
<div class="math notranslate nohighlight">
\[y\left(x\right)\approx\sum_{j}c_{j}\beta^{o}\left(\frac{x}{\Delta x}-j\right).\]</div>
<p>In two dimensions with knot-spacing <span class="math notranslate nohighlight">\(\Delta x\)</span> and <span class="math notranslate nohighlight">\(\Delta y\)</span>, the
function representation is</p>
<div class="math notranslate nohighlight">
\[z\left(x,y\right)\approx\sum_{j}\sum_{k}c_{jk}\beta^{o}\left(\frac{x}{\Delta x}-j\right)\beta^{o}\left(\frac{y}{\Delta y}-k\right).\]</div>
<p>In these expressions, <span class="math notranslate nohighlight">\(\beta^{o}\left(\cdot\right)\)</span> is the space-limited
B-spline basis function of order <span class="math notranslate nohighlight">\(o\)</span>. The requirement of equally-spaced
knot-points and equally-spaced data points, allows the development of fast
(inverse-filtering) algorithms for determining the coefficients, <span class="math notranslate nohighlight">\(c_{j}\)</span>,
from sample-values, <span class="math notranslate nohighlight">\(y_{n}\)</span>. Unlike the general spline interpolation
algorithms, these algorithms can quickly find the spline coefficients for large
images.</p>
<p>The advantage of representing a set of samples via B-spline basis
functions is that continuous-domain operators (derivatives, re-
sampling, integral, etc.), which assume that the data samples are drawn
from an underlying continuous function, can be computed with relative
ease from the spline coefficients. For example, the second derivative
of a spline is</p>
<div class="math notranslate nohighlight">
\[y{}^{\prime\prime}\left(x\right)=\frac{1}{\Delta x^{2}}\sum_{j}c_{j}\beta^{o\prime\prime}\left(\frac{x}{\Delta x}-j\right).\]</div>
<p>Using the property of B-splines that</p>
<div class="math notranslate nohighlight">
\[\frac{d^{2}\beta^{o}\left(w\right)}{dw^{2}}=\beta^{o-2}\left(w+1\right)-2\beta^{o-2}\left(w\right)+\beta^{o-2}\left(w-1\right),\]</div>
<p>it can be seen that</p>
<div class="math notranslate nohighlight">
\[y^{\prime\prime}\left(x\right)=\frac{1}{\Delta x^{2}}\sum_{j}c_{j}\left[\beta^{o-2}\left(\frac{x}{\Delta x}-j+1\right)-2\beta^{o-2}\left(\frac{x}{\Delta x}-j\right)+\beta^{o-2}\left(\frac{x}{\Delta x}-j-1\right)\right].\]</div>
<p>If <span class="math notranslate nohighlight">\(o=3\)</span>, then at the sample points:</p>
<div class="math notranslate nohighlight">
 \begin{eqnarray*} \Delta x^{2}\left.y^{\prime}\left(x\right)\right|_{x=n\Delta x} &amp; = &amp; \sum_{j}c_{j}\delta_{n-j+1}-2c_{j}\delta_{n-j}+c_{j}\delta_{n-j-1},\\  &amp; = &amp; c_{n+1}-2c_{n}+c_{n-1}.\end{eqnarray*}</div><p>Thus, the second-derivative signal can be easily calculated from the spline
fit. If desired, smoothing splines can be found to make the second derivative
less sensitive to random errors.</p>
<p>The savvy reader will have already noticed that the data samples are related
to the knot coefficients via a convolution operator, so that simple
convolution with the sampled B-spline function recovers the original data from
the spline coefficients. The output of convolutions can change depending on
how the boundaries are handled (this becomes increasingly more important as the
number of dimensions in the dataset increases). The algorithms relating to
B-splines in the signal-processing subpackage assume mirror-symmetric
boundary conditions. Thus, spline coefficients are computed based on that
assumption, and data-samples can be recovered exactly from the spline
coefficients by assuming them to be mirror-symmetric also.</p>
<p>Currently the package provides functions for determining second- and third-
order cubic spline coefficients from equally-spaced samples in one and two
dimensions (<a class="reference internal" href="../reference/generated/scipy.signal.qspline1d.html#scipy.signal.qspline1d" title="scipy.signal.qspline1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">qspline1d</span></code></a>, <a class="reference internal" href="../reference/generated/scipy.signal.qspline2d.html#scipy.signal.qspline2d" title="scipy.signal.qspline2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">qspline2d</span></code></a>, <a class="reference internal" href="../reference/generated/scipy.signal.cspline1d.html#scipy.signal.cspline1d" title="scipy.signal.cspline1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">cspline1d</span></code></a>,
<a class="reference internal" href="../reference/generated/scipy.signal.cspline2d.html#scipy.signal.cspline2d" title="scipy.signal.cspline2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">cspline2d</span></code></a>). The package also supplies a function ( <a class="reference internal" href="../reference/generated/scipy.signal.bspline.html#scipy.signal.bspline" title="scipy.signal.bspline"><code class="xref py py-func docutils literal notranslate"><span class="pre">bspline</span></code></a> )
for evaluating the B-spline basis function, <span class="math notranslate nohighlight">\(\beta^{o}\left(x\right)\)</span> for
arbitrary order and <span class="math notranslate nohighlight">\(x.\)</span> For large <span class="math notranslate nohighlight">\(o\)</span>, the B-spline basis
function can be approximated well by a zero-mean Gaussian function with
standard-deviation equal to <span class="math notranslate nohighlight">\(\sigma_{o}=\left(o+1\right)/12\)</span> :</p>
<div class="math notranslate nohighlight">
\[\beta^{o}\left(x\right)\approx\frac{1}{\sqrt{2\pi\sigma_{o}^{2}}}\exp\left(-\frac{x^{2}}{2\sigma_{o}}\right).\]</div>
<p>A function to compute this Gaussian for arbitrary <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(o\)</span> is
also available ( <a class="reference internal" href="../reference/generated/scipy.signal.gauss_spline.html#scipy.signal.gauss_spline" title="scipy.signal.gauss_spline"><code class="xref py py-func docutils literal notranslate"><span class="pre">gauss_spline</span></code></a> ). The following code and figure use
spline-filtering to compute an edge-image (the second derivative of a smoothed
spline) of a raccoon’s face, which is an array returned by the command <a class="reference internal" href="../reference/generated/scipy.datasets.face.html#scipy.datasets.face" title="scipy.datasets.face"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.datasets.face</span></code></a>.
The command <a class="reference internal" href="../reference/generated/scipy.signal.sepfir2d.html#scipy.signal.sepfir2d" title="scipy.signal.sepfir2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">sepfir2d</span></code></a> was used to apply a separable 2-D FIR
filter with mirror-symmetric boundary conditions to the spline coefficients.
This function is ideally-suited for reconstructing samples from spline
coefficients and is faster than <a class="reference internal" href="../reference/generated/scipy.signal.convolve2d.html#scipy.signal.convolve2d" title="scipy.signal.convolve2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">convolve2d</span></code></a>, which convolves arbitrary
2-D filters and allows for choosing mirror-symmetric boundary
conditions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span><span class="p">,</span> <span class="n">datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">derfilt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ck</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cspline2d</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deriv</span> <span class="o">=</span> <span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">sepfir2d</span><span class="p">(</span><span class="n">ck</span><span class="p">,</span> <span class="n">derfilt</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
<span class="gp">... </span>         <span class="n">signal</span><span class="o">.</span><span class="n">sepfir2d</span><span class="p">(</span><span class="n">ck</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">derfilt</span><span class="p">))</span>
</pre></div>
</div>
<p>Alternatively, we could have done:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">laplacian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">deriv2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">convolve2d</span><span class="p">(</span><span class="n">ck</span><span class="p">,</span><span class="n">laplacian</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span><span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;symm&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original image&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Output of spline edge filter&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="filtering">
<h2>Filtering<a class="headerlink" href="#filtering" title="Permalink to this heading">#</a></h2>
<p>Filtering is a generic name for any system that modifies an input
signal in some way. In SciPy, a signal can be thought of as a NumPy
array. There are different kinds of filters for different kinds of
operations. There are two broad kinds of filtering operations: linear
and non-linear. Linear filters can always be reduced to multiplication
of the flattened NumPy array by an appropriate matrix resulting in
another flattened NumPy array. Of course, this is not usually the best
way to compute the filter, as the matrices and vectors involved may be
huge. For example, filtering a <span class="math notranslate nohighlight">\(512 \times 512\)</span> image with this
method would require multiplication of a <span class="math notranslate nohighlight">\(512^2 \times 512^2\)</span>
matrix with a <span class="math notranslate nohighlight">\(512^2\)</span> vector. Just trying to store the
<span class="math notranslate nohighlight">\(512^2 \times 512^2\)</span> matrix using a standard NumPy array would
require <span class="math notranslate nohighlight">\(68,719,476,736\)</span> elements. At 4 bytes per element this
would require <span class="math notranslate nohighlight">\(256\textrm{GB}\)</span> of memory. In most applications,
most of the elements of this matrix are zero and a different method
for computing the output of the filter is employed.</p>
<section id="convolution-correlation">
<h3>Convolution/Correlation<a class="headerlink" href="#convolution-correlation" title="Permalink to this heading">#</a></h3>
<p>Many linear filters also have the property of shift-invariance. This
means that the filtering operation is the same at different locations
in the signal and it implies that the filtering matrix can be
constructed from knowledge of one row (or column) of the matrix alone.
In this case, the matrix multiplication can be accomplished using
Fourier transforms.</p>
<p>Let <span class="math notranslate nohighlight">\(x\left[n\right]\)</span> define a 1-D signal indexed by the
integer <span class="math notranslate nohighlight">\(n.\)</span> Full convolution of two 1-D signals can be
expressed as</p>
<div class="math notranslate nohighlight">
\[y\left[n\right]=\sum_{k=-\infty}^{\infty}x\left[k\right]h\left[n-k\right].\]</div>
<p>This equation can only be implemented directly if we limit the
sequences to finite-support sequences that can be stored in a
computer, choose <span class="math notranslate nohighlight">\(n=0\)</span> to be the starting point of both
sequences, let <span class="math notranslate nohighlight">\(K+1\)</span> be that value for which
<span class="math notranslate nohighlight">\(x\left[n\right]=0\)</span> for all <span class="math notranslate nohighlight">\(n\geq K+1\)</span> and <span class="math notranslate nohighlight">\(M+1\)</span> be
that value for which <span class="math notranslate nohighlight">\(h\left[n\right]=0\)</span> for all <span class="math notranslate nohighlight">\(n\geq M+1\)</span>,
then the discrete convolution expression is</p>
<div class="math notranslate nohighlight">
\[y\left[n\right]=\sum_{k=\max\left(n-M,0\right)}^{\min\left(n,K\right)}x\left[k\right]h\left[n-k\right].\]</div>
<p>For convenience, assume <span class="math notranslate nohighlight">\(K\geq M.\)</span> Then, more explicitly, the output of
this operation is</p>
<div class="math notranslate nohighlight">
 \begin{eqnarray*} y\left[0\right] &amp; = &amp; x\left[0\right]h\left[0\right]\\ y\left[1\right] &amp; = &amp; x\left[0\right]h\left[1\right]+x\left[1\right]h\left[0\right]\\ y\left[2\right] &amp; = &amp; x\left[0\right]h\left[2\right]+x\left[1\right]h\left[1\right]+x\left[2\right]h\left[0\right]\\ \vdots &amp; \vdots &amp; \vdots\\ y\left[M\right] &amp; = &amp; x\left[0\right]h\left[M\right]+x\left[1\right]h\left[M-1\right]+\cdots+x\left[M\right]h\left[0\right]\\ y\left[M+1\right] &amp; = &amp; x\left[1\right]h\left[M\right]+x\left[2\right]h\left[M-1\right]+\cdots+x\left[M+1\right]h\left[0\right]\\ \vdots &amp; \vdots &amp; \vdots\\ y\left[K\right] &amp; = &amp; x\left[K-M\right]h\left[M\right]+\cdots+x\left[K\right]h\left[0\right]\\ y\left[K+1\right] &amp; = &amp; x\left[K+1-M\right]h\left[M\right]+\cdots+x\left[K\right]h\left[1\right]\\ \vdots &amp; \vdots &amp; \vdots\\ y\left[K+M-1\right] &amp; = &amp; x\left[K-1\right]h\left[M\right]+x\left[K\right]h\left[M-1\right]\\ y\left[K+M\right] &amp; = &amp; x\left[K\right]h\left[M\right].\end{eqnarray*}</div><p>Thus, the full discrete convolution of two finite sequences of lengths
<span class="math notranslate nohighlight">\(K+1\)</span> and <span class="math notranslate nohighlight">\(M+1\)</span>, respectively, results in a finite sequence of length
<span class="math notranslate nohighlight">\(K+M+1=\left(K+1\right)+\left(M+1\right)-1.\)</span></p>
<p>1-D convolution is implemented in SciPy with the function
<a class="reference internal" href="../reference/generated/scipy.signal.convolve.html#scipy.signal.convolve" title="scipy.signal.convolve"><code class="xref py py-func docutils literal notranslate"><span class="pre">convolve</span></code></a>. This function takes as inputs the signals <span class="math notranslate nohighlight">\(x,\)</span>
<span class="math notranslate nohighlight">\(h\)</span>, and two optional flags ‘mode’ and ‘method’, and returns the signal
<span class="math notranslate nohighlight">\(y.\)</span></p>
<p>The first optional flag, ‘mode’, allows for the specification of which part of the
output signal to return. The default value of ‘full’ returns the entire signal.
If the flag has a value of ‘same’, then only the middle <span class="math notranslate nohighlight">\(K\)</span> values are
returned, starting at <span class="math notranslate nohighlight">\(y\left[\left\lfloor \frac{M-1}{2}\right\rfloor
\right]\)</span>, so that the output has the same length as the first input. If the flag
has a value of ‘valid’, then only the middle
<span class="math notranslate nohighlight">\(K-M+1=\left(K+1\right)-\left(M+1\right)+1\)</span> output values are returned,
where <span class="math notranslate nohighlight">\(z\)</span> depends on all of the values of the smallest input from
<span class="math notranslate nohighlight">\(h\left[0\right]\)</span> to <span class="math notranslate nohighlight">\(h\left[M\right].\)</span> In other words, only the
values <span class="math notranslate nohighlight">\(y\left[M\right]\)</span> to <span class="math notranslate nohighlight">\(y\left[K\right]\)</span> inclusive are
returned.</p>
<p>The second optional flag, ‘method’, determines how the convolution is computed,
either through the Fourier transform approach with <a class="reference internal" href="../reference/generated/scipy.signal.fftconvolve.html#scipy.signal.fftconvolve" title="scipy.signal.fftconvolve"><code class="xref py py-func docutils literal notranslate"><span class="pre">fftconvolve</span></code></a> or
through the direct method. By default, it selects the expected faster method.
The Fourier transform method has order <span class="math notranslate nohighlight">\(O(N\log N)\)</span>, while the direct
method has order <span class="math notranslate nohighlight">\(O(N^2)\)</span>. Depending on the big O constant and the value
of <span class="math notranslate nohighlight">\(N\)</span>, one of these two methods may be faster. The default value, ‘auto’,
performs a rough calculation and chooses the expected faster method, while the
values ‘direct’ and ‘fft’ force computation with the other two methods.</p>
<p>The code below shows a simple example for convolution of 2 sequences:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="go">array([ 0.,  1.,  2.,  3.,  0.,  0.,  0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="go">array([ 2.,  3.,  0.])</span>
</pre></div>
</div>
<p>This same function <a class="reference internal" href="../reference/generated/scipy.signal.convolve.html#scipy.signal.convolve" title="scipy.signal.convolve"><code class="xref py py-func docutils literal notranslate"><span class="pre">convolve</span></code></a> can actually take N-D
arrays as inputs and will return the N-D convolution of the
two arrays, as is shown in the code example below. The same input flags are
available for that case as well.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="go">array([[ 1.,  1.,  0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 1.,  1.,  0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.,  1.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.,  1.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.]])</span>
</pre></div>
</div>
<p>Correlation is very similar to convolution except that the minus sign
becomes a plus sign. Thus,</p>
<div class="math notranslate nohighlight">
\[w\left[n\right]=\sum_{k=-\infty}^{\infty}y\left[k\right]x\left[n+k\right],\]</div>
<p>is the (cross) correlation of the signals <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x.\)</span> For
finite-length signals with <span class="math notranslate nohighlight">\(y\left[n\right]=0\)</span> outside of the range
<span class="math notranslate nohighlight">\(\left[0,K\right]\)</span> and <span class="math notranslate nohighlight">\(x\left[n\right]=0\)</span> outside of the range
<span class="math notranslate nohighlight">\(\left[0,M\right],\)</span> the summation can simplify to</p>
<div class="math notranslate nohighlight">
\[w\left[n\right]=\sum_{k=\max\left(0,-n\right)}^{\min\left(K,M-n\right)}y\left[k\right]x\left[n+k\right].\]</div>
<p>Assuming again that <span class="math notranslate nohighlight">\(K\geq M\)</span>, this is</p>
<div class="math notranslate nohighlight">
 \begin{eqnarray*} w\left[-K\right] &amp; = &amp; y\left[K\right]x\left[0\right]\\ w\left[-K+1\right] &amp; = &amp; y\left[K-1\right]x\left[0\right]+y\left[K\right]x\left[1\right]\\ \vdots &amp; \vdots &amp; \vdots\\ w\left[M-K\right] &amp; = &amp; y\left[K-M\right]x\left[0\right]+y\left[K-M+1\right]x\left[1\right]+\cdots+y\left[K\right]x\left[M\right]\\ w\left[M-K+1\right] &amp; = &amp; y\left[K-M-1\right]x\left[0\right]+\cdots+y\left[K-1\right]x\left[M\right]\\ \vdots &amp; \vdots &amp; \vdots\\ w\left[-1\right] &amp; = &amp; y\left[1\right]x\left[0\right]+y\left[2\right]x\left[1\right]+\cdots+y\left[M+1\right]x\left[M\right]\\ w\left[0\right] &amp; = &amp; y\left[0\right]x\left[0\right]+y\left[1\right]x\left[1\right]+\cdots+y\left[M\right]x\left[M\right]\\ w\left[1\right] &amp; = &amp; y\left[0\right]x\left[1\right]+y\left[1\right]x\left[2\right]+\cdots+y\left[M-1\right]x\left[M\right]\\ w\left[2\right] &amp; = &amp; y\left[0\right]x\left[2\right]+y\left[1\right]x\left[3\right]+\cdots+y\left[M-2\right]x\left[M\right]\\ \vdots &amp; \vdots &amp; \vdots\\ w\left[M-1\right] &amp; = &amp; y\left[0\right]x\left[M-1\right]+y\left[1\right]x\left[M\right]\\ w\left[M\right] &amp; = &amp; y\left[0\right]x\left[M\right].\end{eqnarray*}</div><p>The SciPy function <a class="reference internal" href="../reference/generated/scipy.signal.correlate.html#scipy.signal.correlate" title="scipy.signal.correlate"><code class="xref py py-func docutils literal notranslate"><span class="pre">correlate</span></code></a> implements this operation. Equivalent
flags are available for this operation to return the full <span class="math notranslate nohighlight">\(K+M+1\)</span> length
sequence (‘full’) or a sequence with the same size as the largest sequence
starting at <span class="math notranslate nohighlight">\(w\left[-K+\left\lfloor \frac{M-1}{2}\right\rfloor \right]\)</span>
(‘same’) or a sequence where the values depend on all the values of the
smallest sequence (‘valid’). This final option returns the <span class="math notranslate nohighlight">\(K-M+1\)</span>
values <span class="math notranslate nohighlight">\(w\left[M-K\right]\)</span> to <span class="math notranslate nohighlight">\(w\left[0\right]\)</span> inclusive.</p>
<p>The function <a class="reference internal" href="../reference/generated/scipy.signal.correlate.html#scipy.signal.correlate" title="scipy.signal.correlate"><code class="xref py py-func docutils literal notranslate"><span class="pre">correlate</span></code></a> can also take arbitrary N-D arrays as input
and return the N-D convolution of the two arrays on output.</p>
<p>When <span class="math notranslate nohighlight">\(N=2,\)</span> <a class="reference internal" href="../reference/generated/scipy.signal.correlate.html#scipy.signal.correlate" title="scipy.signal.correlate"><code class="xref py py-func docutils literal notranslate"><span class="pre">correlate</span></code></a> and/or <a class="reference internal" href="../reference/generated/scipy.signal.convolve.html#scipy.signal.convolve" title="scipy.signal.convolve"><code class="xref py py-func docutils literal notranslate"><span class="pre">convolve</span></code></a> can be used
to construct arbitrary image filters to perform actions such as blurring,
enhancing, and edge-detection for an image.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span><span class="p">,</span> <span class="n">datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">[</span><span class="mi">49</span><span class="p">][</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_new</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original image&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_new</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Filtered image&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Calculating the convolution in the time domain as above is mainly used for
filtering when one of the signals is much smaller than the other ( <span class="math notranslate nohighlight">\(K\gg
M\)</span> ), otherwise linear filtering is more efficiently calculated in the
frequency domain provided by the function <a class="reference internal" href="../reference/generated/scipy.signal.fftconvolve.html#scipy.signal.fftconvolve" title="scipy.signal.fftconvolve"><code class="xref py py-func docutils literal notranslate"><span class="pre">fftconvolve</span></code></a>. By default,
<a class="reference internal" href="../reference/generated/scipy.signal.convolve.html#scipy.signal.convolve" title="scipy.signal.convolve"><code class="xref py py-func docutils literal notranslate"><span class="pre">convolve</span></code></a> estimates the fastest method using <a class="reference internal" href="../reference/generated/scipy.signal.choose_conv_method.html#scipy.signal.choose_conv_method" title="scipy.signal.choose_conv_method"><code class="xref py py-func docutils literal notranslate"><span class="pre">choose_conv_method</span></code></a>.</p>
<p>If the filter function <span class="math notranslate nohighlight">\(w[n,m]\)</span> can be factored according to</p>
<div class="math notranslate nohighlight">
\[h[n, m] = h_1[n] h_2[m],\]</div>
<p>convolution can be calculated by means of the function <a class="reference internal" href="../reference/generated/scipy.signal.sepfir2d.html#scipy.signal.sepfir2d" title="scipy.signal.sepfir2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">sepfir2d</span></code></a>. As an
example, we consider a Gaussian filter <a class="reference internal" href="../reference/generated/scipy.signal.windows.gaussian.html#scipy.signal.windows.gaussian" title="scipy.signal.windows.gaussian"><code class="xref py py-func docutils literal notranslate"><span class="pre">gaussian</span></code></a></p>
<div class="math notranslate nohighlight">
\[h[n, m] \propto e^{-x^2-y^2} = e^{-x^2} e^{-y^2},\]</div>
<p>which is often used for blurring.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span><span class="p">,</span> <span class="n">datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">ascent</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_new</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sepfir2d</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original image&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_new</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Filtered image&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="difference-equation-filtering">
<h3>Difference-equation filtering<a class="headerlink" href="#difference-equation-filtering" title="Permalink to this heading">#</a></h3>
<p>A general class of linear 1-D filters (that includes convolution
filters) are filters described by the difference equation</p>
<div class="math notranslate nohighlight">
\[\sum_{k=0}^{N}a_{k}y\left[n-k\right]=\sum_{k=0}^{M}b_{k}x\left[n-k\right],\]</div>
<p>where <span class="math notranslate nohighlight">\(x\left[n\right]\)</span> is the input sequence and
<span class="math notranslate nohighlight">\(y\left[n\right]\)</span> is the output sequence. If we assume initial rest so
that <span class="math notranslate nohighlight">\(y\left[n\right]=0\)</span> for <span class="math notranslate nohighlight">\(n&lt;0\)</span>, then this kind of filter can
be implemented using convolution. However, the convolution filter sequence
<span class="math notranslate nohighlight">\(h\left[n\right]\)</span> could be infinite if <span class="math notranslate nohighlight">\(a_{k}\neq0\)</span> for
<span class="math notranslate nohighlight">\(k\geq1.\)</span> In addition, this general class of linear filter allows
initial conditions to be placed on <span class="math notranslate nohighlight">\(y\left[n\right]\)</span> for <span class="math notranslate nohighlight">\(n&lt;0\)</span>
resulting in a filter that cannot be expressed using convolution.</p>
<p>The difference equation filter can be thought of as finding
<span class="math notranslate nohighlight">\(y\left[n\right]\)</span> recursively in terms of its previous values</p>
<div class="math notranslate nohighlight">
\[a_{0}y\left[n\right]=-a_{1}y\left[n-1\right]-\cdots-a_{N}y\left[n-N\right]+\cdots+b_{0}x\left[n\right]+\cdots+b_{M}x\left[n-M\right].\]</div>
<p>Often, <span class="math notranslate nohighlight">\(a_{0}=1\)</span> is chosen for normalization. The implementation in SciPy
of this general difference equation filter is a little more complicated than
would be implied by the previous equation. It is implemented so that only one
signal needs to be delayed. The actual implementation equations are (assuming
<span class="math notranslate nohighlight">\(a_{0}=1\)</span> ):</p>
<div class="math notranslate nohighlight">
 \begin{eqnarray*} y\left[n\right] &amp; = &amp; b_{0}x\left[n\right]+z_{0}\left[n-1\right]\\ z_{0}\left[n\right] &amp; = &amp; b_{1}x\left[n\right]+z_{1}\left[n-1\right]-a_{1}y\left[n\right]\\ z_{1}\left[n\right] &amp; = &amp; b_{2}x\left[n\right]+z_{2}\left[n-1\right]-a_{2}y\left[n\right]\\ \vdots &amp; \vdots &amp; \vdots\\ z_{K-2}\left[n\right] &amp; = &amp; b_{K-1}x\left[n\right]+z_{K-1}\left[n-1\right]-a_{K-1}y\left[n\right]\\ z_{K-1}\left[n\right] &amp; = &amp; b_{K}x\left[n\right]-a_{K}y\left[n\right],\end{eqnarray*}</div><p>where <span class="math notranslate nohighlight">\(K=\max\left(N,M\right).\)</span> Note that <span class="math notranslate nohighlight">\(b_{K}=0\)</span> if <span class="math notranslate nohighlight">\(K&gt;M\)</span>
and <span class="math notranslate nohighlight">\(a_{K}=0\)</span> if <span class="math notranslate nohighlight">\(K&gt;N.\)</span> In this way, the output at time <span class="math notranslate nohighlight">\(n\)</span>
depends only on the input at time <span class="math notranslate nohighlight">\(n\)</span> and the value of <span class="math notranslate nohighlight">\(z_{0}\)</span> at
the previous time. This can always be calculated as long as the <span class="math notranslate nohighlight">\(K\)</span>
values <span class="math notranslate nohighlight">\(z_{0}\left[n-1\right]\ldots z_{K-1}\left[n-1\right]\)</span> are
computed and stored at each time step.</p>
<p>The difference-equation filter is called using the command <a class="reference internal" href="../reference/generated/scipy.signal.lfilter.html#scipy.signal.lfilter" title="scipy.signal.lfilter"><code class="xref py py-func docutils literal notranslate"><span class="pre">lfilter</span></code></a> in
SciPy. This command takes as inputs the vector <span class="math notranslate nohighlight">\(b,\)</span> the vector,
<span class="math notranslate nohighlight">\(a,\)</span> a signal <span class="math notranslate nohighlight">\(x\)</span> and returns the vector <span class="math notranslate nohighlight">\(y\)</span> (the same
length as <span class="math notranslate nohighlight">\(x\)</span> ) computed using the equation given above. If <span class="math notranslate nohighlight">\(x\)</span> is
N-D, then the filter is computed along the axis provided.
If desired, initial conditions providing the values of
<span class="math notranslate nohighlight">\(z_{0}\left[-1\right]\)</span> to <span class="math notranslate nohighlight">\(z_{K-1}\left[-1\right]\)</span> can be provided
or else it will be assumed that they are all zero. If initial conditions are
provided, then the final conditions on the intermediate variables are also
returned. These could be used, for example, to restart the calculation in the
same state.</p>
<p>Sometimes, it is more convenient to express the initial conditions in terms of
the signals <span class="math notranslate nohighlight">\(x\left[n\right]\)</span> and <span class="math notranslate nohighlight">\(y\left[n\right].\)</span> In other
words, perhaps you have the values of <span class="math notranslate nohighlight">\(x\left[-M\right]\)</span> to
<span class="math notranslate nohighlight">\(x\left[-1\right]\)</span> and the values of <span class="math notranslate nohighlight">\(y\left[-N\right]\)</span> to
<span class="math notranslate nohighlight">\(y\left[-1\right]\)</span> and would like to determine what values of
<span class="math notranslate nohighlight">\(z_{m}\left[-1\right]\)</span> should be delivered as initial conditions to the
difference-equation filter. It is not difficult to show that, for <span class="math notranslate nohighlight">\(0\leq
m&lt;K,\)</span></p>
<div class="math notranslate nohighlight">
\[z_{m}\left[n\right]=\sum_{p=0}^{K-m-1}\left(b_{m+p+1}x\left[n-p\right]-a_{m+p+1}y\left[n-p\right]\right).\]</div>
<p>Using this formula, we can find the initial-condition vector
<span class="math notranslate nohighlight">\(z_{0}\left[-1\right]\)</span> to <span class="math notranslate nohighlight">\(z_{K-1}\left[-1\right]\)</span> given initial
conditions on <span class="math notranslate nohighlight">\(y\)</span> (and <span class="math notranslate nohighlight">\(x\)</span> ). The command <a class="reference internal" href="../reference/generated/scipy.signal.lfiltic.html#scipy.signal.lfiltic" title="scipy.signal.lfiltic"><code class="xref py py-func docutils literal notranslate"><span class="pre">lfiltic</span></code></a> performs
this function.</p>
<p>As an example, consider the following system:</p>
<div class="math notranslate nohighlight">
\[y[n] = \frac{1}{2} x[n] + \frac{1}{4} x[n-1] + \frac{1}{3} y[n-1]\]</div>
<p>The code calculates the signal <span class="math notranslate nohighlight">\(y[n]\)</span> for a given signal <span class="math notranslate nohighlight">\(x[n]\)</span>;
first for initial conditions <span class="math notranslate nohighlight">\(y[-1] = 0\)</span> (default case), then for
<span class="math notranslate nohighlight">\(y[-1] = 2\)</span> by means of <a class="reference internal" href="../reference/generated/scipy.signal.lfiltic.html#scipy.signal.lfiltic" title="scipy.signal.lfiltic"><code class="xref py py-func docutils literal notranslate"><span class="pre">lfiltic</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">array([0.5, 0.41666667, 0.13888889, 0.0462963])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zi</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfiltic</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mf">2.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">zi</span><span class="o">=</span><span class="n">zi</span><span class="p">)</span>
<span class="go">(array([ 1.16666667,  0.63888889,  0.21296296,  0.07098765]), array([0.02366]))</span>
</pre></div>
</div>
<p>Note that the output signal <span class="math notranslate nohighlight">\(y[n]\)</span> has the same length as the length as
the input signal <span class="math notranslate nohighlight">\(x[n]\)</span>.</p>
<section id="analysis-of-linear-systems">
<h4>Analysis of Linear Systems<a class="headerlink" href="#analysis-of-linear-systems" title="Permalink to this heading">#</a></h4>
<p>Linear system described a linear-difference equation can be fully described by
the coefficient vectors <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> as was done above; an alternative
representation is to provide a factor <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(N_z\)</span> zeros <span class="math notranslate nohighlight">\(z_k\)</span>
and <span class="math notranslate nohighlight">\(N_p\)</span> poles <span class="math notranslate nohighlight">\(p_k\)</span>, respectively, to describe the system by
means of its transfer function <span class="math notranslate nohighlight">\(H(z)\)</span>, according to</p>
<div class="math notranslate nohighlight">
\[H(z) = k \frac{ (z-z_1)(z-z_2)...(z-z_{N_z})}{ (z-p_1)(z-p_2)...(z-p_{N_p})}.\]</div>
<p>This alternative representation can be obtained with the scipy function
<a class="reference internal" href="../reference/generated/scipy.signal.tf2zpk.html#scipy.signal.tf2zpk" title="scipy.signal.tf2zpk"><code class="xref py py-func docutils literal notranslate"><span class="pre">tf2zpk</span></code></a>; the inverse is provided by <a class="reference internal" href="../reference/generated/scipy.signal.zpk2tf.html#scipy.signal.zpk2tf" title="scipy.signal.zpk2tf"><code class="xref py py-func docutils literal notranslate"><span class="pre">zpk2tf</span></code></a>.</p>
<p>For the above example we have</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">tf2zpk</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(array([-0.5]), array([ 0.33333333]), 0.5)</span>
</pre></div>
</div>
<p>i.e., the system has a zero at <span class="math notranslate nohighlight">\(z=-1/2\)</span> and a pole at <span class="math notranslate nohighlight">\(z=1/3\)</span>.</p>
<p>The scipy function <a class="reference internal" href="../reference/generated/scipy.signal.freqz.html#scipy.signal.freqz" title="scipy.signal.freqz"><code class="xref py py-func docutils literal notranslate"><span class="pre">freqz</span></code></a> allows calculation of the frequency response
of a system described by the coefficients <span class="math notranslate nohighlight">\(a_k\)</span> and <span class="math notranslate nohighlight">\(b_k\)</span>. See the
help of the <a class="reference internal" href="../reference/generated/scipy.signal.freqz.html#scipy.signal.freqz" title="scipy.signal.freqz"><code class="xref py py-func docutils literal notranslate"><span class="pre">freqz</span></code></a> function for a comprehensive example.</p>
</section>
</section>
<section id="filter-design">
<h3>Filter Design<a class="headerlink" href="#filter-design" title="Permalink to this heading">#</a></h3>
<p>Time-discrete filters can be classified into finite response (FIR) filters and
infinite response (IIR) filters. FIR filters can provide a linear phase
response, whereas IIR filters cannot. SciPy provides functions
for designing both types of filters.</p>
<section id="fir-filter">
<h4>FIR Filter<a class="headerlink" href="#fir-filter" title="Permalink to this heading">#</a></h4>
<p>The function <a class="reference internal" href="../reference/generated/scipy.signal.firwin.html#scipy.signal.firwin" title="scipy.signal.firwin"><code class="xref py py-func docutils literal notranslate"><span class="pre">firwin</span></code></a> designs filters according to the window method.
Depending on the provided arguments, the function returns different filter
types (e.g., low-pass, band-pass…).</p>
<p>The example below designs a low-pass and a band-stop filter, respectively.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b1</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w1</span><span class="p">,</span> <span class="n">h1</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w2</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Digital filter frequency response&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h1</span><span class="p">)),</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h2</span><span class="p">)),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude Response (dB)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (rad/sample)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="&quot;This code displays an X-Y plot with the amplitude response on the Y axis vs frequency on the X axis. The first (low-pass) trace in blue starts with a pass-band at 0 dB and curves down around halfway through with some ripple in the stop-band about 80 dB down. The second (band-stop) trace in red starts and ends at 0 dB, but the middle third is down about 60 dB from the peak with some ripple where the filter would supress a signal.&quot;" class="plot-directive" src="../_images/signal-4.png" />
</figure>
<p>Note that <a class="reference internal" href="../reference/generated/scipy.signal.firwin.html#scipy.signal.firwin" title="scipy.signal.firwin"><code class="xref py py-func docutils literal notranslate"><span class="pre">firwin</span></code></a> uses, per default, a normalized frequency defined such
that the value <span class="math notranslate nohighlight">\(1\)</span> corresponds to the Nyquist frequency, whereas the
function <a class="reference internal" href="../reference/generated/scipy.signal.freqz.html#scipy.signal.freqz" title="scipy.signal.freqz"><code class="xref py py-func docutils literal notranslate"><span class="pre">freqz</span></code></a> is defined such that the value <span class="math notranslate nohighlight">\(\pi\)</span> corresponds
to the Nyquist frequency.</p>
<p>The function <a class="reference internal" href="../reference/generated/scipy.signal.firwin2.html#scipy.signal.firwin2" title="scipy.signal.firwin2"><code class="xref py py-func docutils literal notranslate"><span class="pre">firwin2</span></code></a> allows design of almost arbitrary frequency
responses by specifying an array of corner frequencies and corresponding
gains, respectively.</p>
<p>The example below designs a filter with such an arbitrary amplitude response.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin2</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Digital filter frequency response&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Digital filter frequency response&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude Response&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (rad/sample)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="&quot;This code displays an X-Y plot with amplitude response on the Y axis vs frequency on the X axis. A single trace forms a shape similar to a heartbeat signal.&quot;" class="plot-directive" src="../_images/signal-5.png" />
</figure>
<p>Note the linear scaling of the y-axis and the different definition of the
Nyquist frequency in <a class="reference internal" href="../reference/generated/scipy.signal.firwin2.html#scipy.signal.firwin2" title="scipy.signal.firwin2"><code class="xref py py-func docutils literal notranslate"><span class="pre">firwin2</span></code></a> and <a class="reference internal" href="../reference/generated/scipy.signal.freqz.html#scipy.signal.freqz" title="scipy.signal.freqz"><code class="xref py py-func docutils literal notranslate"><span class="pre">freqz</span></code></a> (as explained above).</p>
</section>
<section id="iir-filter">
<h4>IIR Filter<a class="headerlink" href="#iir-filter" title="Permalink to this heading">#</a></h4>
<p>SciPy provides two functions to directly design IIR <a class="reference internal" href="../reference/generated/scipy.signal.iirdesign.html#scipy.signal.iirdesign" title="scipy.signal.iirdesign"><code class="xref py py-func docutils literal notranslate"><span class="pre">iirdesign</span></code></a> and
<a class="reference internal" href="../reference/generated/scipy.signal.iirfilter.html#scipy.signal.iirfilter" title="scipy.signal.iirfilter"><code class="xref py py-func docutils literal notranslate"><span class="pre">iirfilter</span></code></a>, where the filter type (e.g., elliptic) is passed as an
argument and several more filter design functions for specific filter types,
e.g., <a class="reference internal" href="../reference/generated/scipy.signal.ellip.html#scipy.signal.ellip" title="scipy.signal.ellip"><code class="xref py py-func docutils literal notranslate"><span class="pre">ellip</span></code></a>.</p>
<p>The example below designs an elliptic low-pass filter with defined pass-band
and stop-band ripple, respectively. Note the much lower filter order (order 4)
compared with the FIR filters from the examples above in order to reach the same
stop-band attenuation of <span class="math notranslate nohighlight">\(\approx 60\)</span> dB.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">iirfilter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">rs</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;ellip&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Digital filter frequency response&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Digital filter frequency response&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude Response [dB]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (rad/sample)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="&quot;This code generates an X-Y plot with amplitude response on the Y axis vs Frequency on the X axis. A single trace shows a smooth low-pass filter with the left third passband near 0 dB. The right two-thirds are about 60 dB down with two sharp narrow valleys dipping down to -100 dB.&quot;" class="plot-directive" src="../_images/signal-6.png" />
</figure>
</section>
<section id="filter-coefficients">
<h4>Filter Coefficients<a class="headerlink" href="#filter-coefficients" title="Permalink to this heading">#</a></h4>
<p>Filter coefficients can be stored in several different formats:</p>
<ul class="simple">
<li><p>‘ba’ or ‘tf’ = transfer function coefficients</p></li>
<li><p>‘zpk’ = zeros, poles, and overall gain</p></li>
<li><p>‘ss’ = state-space system representation</p></li>
<li><p>‘sos’ = transfer function coefficients of second-order sections</p></li>
</ul>
<p>Functions, such as <a class="reference internal" href="../reference/generated/scipy.signal.tf2zpk.html#scipy.signal.tf2zpk" title="scipy.signal.tf2zpk"><code class="xref py py-func docutils literal notranslate"><span class="pre">tf2zpk</span></code></a> and <a class="reference internal" href="../reference/generated/scipy.signal.zpk2ss.html#scipy.signal.zpk2ss" title="scipy.signal.zpk2ss"><code class="xref py py-func docutils literal notranslate"><span class="pre">zpk2ss</span></code></a>, can convert between them.</p>
<section id="transfer-function-representation">
<h5>Transfer function representation<a class="headerlink" href="#transfer-function-representation" title="Permalink to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">ba</span></code> or <code class="docutils literal notranslate"><span class="pre">tf</span></code> format is a 2-tuple <code class="docutils literal notranslate"><span class="pre">(b,</span> <span class="pre">a)</span></code> representing a transfer
function, where <em class="xref py py-obj">b</em> is a length <code class="docutils literal notranslate"><span class="pre">M+1</span></code> array of coefficients of the <em class="xref py py-obj">M</em>-order
numerator polynomial, and <em class="xref py py-obj">a</em> is a length <code class="docutils literal notranslate"><span class="pre">N+1</span></code> array of coefficients of the
<em class="xref py py-obj">N</em>-order denominator, as positive, descending powers of the transfer function
variable. So the tuple of <span class="math notranslate nohighlight">\(b = [b_0, b_1, ..., b_M]\)</span> and
<span class="math notranslate nohighlight">\(a =[a_0, a_1, ..., a_N]\)</span> can represent an analog filter of the form:</p>
<div class="math notranslate nohighlight">
\[H(s) = \frac
{b_0 s^M + b_1 s^{(M-1)} + \cdots + b_M}
{a_0 s^N + a_1 s^{(N-1)} + \cdots + a_N}
= \frac
{\sum_{i=0}^M b_i s^{(M-i)}}
{\sum_{i=0}^N a_i s^{(N-i)}}\]</div>
<p>or a discrete-time filter of the form:</p>
<div class="math notranslate nohighlight">
\[H(z) = \frac
{b_0 z^M + b_1 z^{(M-1)} + \cdots + b_M}
{a_0 z^N + a_1 z^{(N-1)} + \cdots + a_N}
= \frac
{\sum_{i=0}^M b_i z^{(M-i)}}
{\sum_{i=0}^N a_i z^{(N-i)}}.\]</div>
<p>This “positive powers” form is found more commonly in controls
engineering.  If <em class="xref py py-obj">M</em> and <em class="xref py py-obj">N</em> are equal (which is true for all filters
generated by the bilinear transform), then this happens to be equivalent
to the “negative powers” discrete-time form preferred in DSP:</p>
<div class="math notranslate nohighlight">
\[H(z) = \frac
{b_0 + b_1 z^{-1} + \cdots + b_M z^{-M}}
{a_0 + a_1 z^{-1} + \cdots + a_N z^{-N}}
= \frac
{\sum_{i=0}^M b_i z^{-i}}
{\sum_{i=0}^N a_i z^{-i}}.\]</div>
<p>Although this is true for common filters, remember that this is not true
in the general case. If <em class="xref py py-obj">M</em> and <em class="xref py py-obj">N</em> are not equal, the discrete-time
transfer function coefficients must first be converted to the “positive
powers” form before finding the poles and zeros.</p>
<p>This representation suffers from numerical error at higher orders, so other
formats are preferred when possible.</p>
</section>
<section id="zeros-and-poles-representation">
<h5>Zeros and poles representation<a class="headerlink" href="#zeros-and-poles-representation" title="Permalink to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">zpk</span></code> format is a 3-tuple <code class="docutils literal notranslate"><span class="pre">(z,</span> <span class="pre">p,</span> <span class="pre">k)</span></code>, where <em class="xref py py-obj">z</em> is an <em class="xref py py-obj">M</em>-length
array of the complex zeros of the transfer function
<span class="math notranslate nohighlight">\(z = [z_0, z_1, ..., z_{M-1}]\)</span>, <em class="xref py py-obj">p</em> is an <em class="xref py py-obj">N</em>-length array of the
complex poles of the transfer function <span class="math notranslate nohighlight">\(p = [p_0, p_1, ..., p_{N-1}]\)</span>,
and <em class="xref py py-obj">k</em> is a scalar gain.  These represent the digital transfer function:</p>
<div class="math notranslate nohighlight">
\[H(z) = k \cdot \frac
{(z - z_0) (z - z_1) \cdots (z - z_{(M-1)})}
{(z - p_0) (z - p_1) \cdots (z - p_{(N-1)})}
= k \frac
{\prod_{i=0}^{M-1} (z - z_i)}
{\prod_{i=0}^{N-1} (z - p_i)}\]</div>
<p>or the analog transfer function:</p>
<div class="math notranslate nohighlight">
\[H(s) = k \cdot \frac
{(s - z_0) (s - z_1) \cdots (s - z_{(M-1)})}
{(s - p_0) (s - p_1) \cdots (s - p_{(N-1)})}
= k \frac
{\prod_{i=0}^{M-1} (s - z_i)}
{\prod_{i=0}^{N-1} (s - p_i)}.\]</div>
<p>Although the sets of roots are stored as ordered NumPy arrays, their ordering
does not matter: <code class="docutils literal notranslate"><span class="pre">([-1,</span> <span class="pre">-2],</span> <span class="pre">[-3,</span> <span class="pre">-4],</span> <span class="pre">1)</span></code> is the same filter as
<code class="docutils literal notranslate"><span class="pre">([-2,</span> <span class="pre">-1],</span> <span class="pre">[-4,</span> <span class="pre">-3],</span> <span class="pre">1)</span></code>.</p>
</section>
<section id="state-space-system-representation">
<h5>State-space system representation<a class="headerlink" href="#state-space-system-representation" title="Permalink to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">ss</span></code> format is a 4-tuple of arrays <code class="docutils literal notranslate"><span class="pre">(A,</span> <span class="pre">B,</span> <span class="pre">C,</span> <span class="pre">D)</span></code> representing the
state-space of an <em class="xref py py-obj">N</em>-order digital/discrete-time system of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{x}[k+1] = A \mathbf{x}[k] + B \mathbf{u}[k]\\
\mathbf{y}[k] = C \mathbf{x}[k] + D \mathbf{u}[k]\end{split}\]</div>
<p>or a continuous/analog system of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\dot{\mathbf{x}}(t) = A \mathbf{x}(t) + B \mathbf{u}(t)\\
\mathbf{y}(t) = C \mathbf{x}(t) + D \mathbf{u}(t),\end{split}\]</div>
<p>with <em class="xref py py-obj">P</em> inputs, <em class="xref py py-obj">Q</em> outputs and <em class="xref py py-obj">N</em> state variables, where:</p>
<ul class="simple">
<li><p><em class="xref py py-obj">x</em> is the state vector</p></li>
<li><p><em class="xref py py-obj">y</em> is the output vector of length <em class="xref py py-obj">Q</em></p></li>
<li><p><em class="xref py py-obj">u</em> is the input vector of length <em class="xref py py-obj">P</em></p></li>
<li><p><em class="xref py py-obj">A</em> is the state matrix, with shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">N)</span></code></p></li>
<li><p><em class="xref py py-obj">B</em> is the input matrix with shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">P)</span></code></p></li>
<li><p><em class="xref py py-obj">C</em> is the output matrix with shape <code class="docutils literal notranslate"><span class="pre">(Q,</span> <span class="pre">N)</span></code></p></li>
<li><p><em class="xref py py-obj">D</em> is the feedthrough or feedforward matrix with shape <code class="docutils literal notranslate"><span class="pre">(Q,</span> <span class="pre">P)</span></code>.  (In
cases where the system does not have a direct feedthrough, all values in
<em class="xref py py-obj">D</em> are zero.)</p></li>
</ul>
<p>State-space is the most general representation and the only one that allows
for multiple-input, multiple-output (MIMO) systems. There are multiple
state-space representations for a given transfer function. Specifically, the
“controllable canonical form” and “observable canonical form” have the same
coefficients as the <code class="docutils literal notranslate"><span class="pre">tf</span></code> representation, and, therefore, suffer from the same
numerical errors.</p>
</section>
<section id="second-order-sections-representation">
<h5>Second-order sections representation<a class="headerlink" href="#second-order-sections-representation" title="Permalink to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">sos</span></code> format is a single 2-D array of shape <code class="docutils literal notranslate"><span class="pre">(n_sections,</span> <span class="pre">6)</span></code>,
representing a sequence of second-order transfer functions which, when
cascaded in series, realize a higher-order filter with minimal numerical
error. Each row corresponds to a second-order <code class="docutils literal notranslate"><span class="pre">tf</span></code> representation, with
the first three columns providing the numerator coefficients and the last
three providing the denominator coefficients:</p>
<div class="math notranslate nohighlight">
\[[b_0, b_1, b_2, a_0, a_1, a_2]\]</div>
<p>The coefficients are typically normalized, such that <span class="math notranslate nohighlight">\(a_0\)</span> is always 1.
The section order is usually not important with floating-point computation;
the filter output will be the same, regardless of the order.</p>
</section>
</section>
<section id="filter-transformations">
<h4>Filter transformations<a class="headerlink" href="#filter-transformations" title="Permalink to this heading">#</a></h4>
<p>The IIR filter design functions first generate a prototype analog low-pass filter
with a normalized cutoff frequency of 1 rad/sec. This is then transformed into
other frequencies and band types using the following substitutions:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Transformation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../reference/generated/scipy.signal.lp2lp.html#scipy.signal.lp2lp" title="scipy.signal.lp2lp"><code class="xref py py-func docutils literal notranslate"><span class="pre">lp2lp</span></code></a></p></td>
<td><p><span class="math notranslate nohighlight">\(s \rightarrow \frac{s}{\omega_0}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../reference/generated/scipy.signal.lp2hp.html#scipy.signal.lp2hp" title="scipy.signal.lp2hp"><code class="xref py py-func docutils literal notranslate"><span class="pre">lp2hp</span></code></a></p></td>
<td><p><span class="math notranslate nohighlight">\(s \rightarrow \frac{\omega_0}{s}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../reference/generated/scipy.signal.lp2bp.html#scipy.signal.lp2bp" title="scipy.signal.lp2bp"><code class="xref py py-func docutils literal notranslate"><span class="pre">lp2bp</span></code></a></p></td>
<td><p><span class="math notranslate nohighlight">\(s \rightarrow \frac{s^2 + {\omega_0}^2}{s \cdot \mathrm{BW}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../reference/generated/scipy.signal.lp2bs.html#scipy.signal.lp2bs" title="scipy.signal.lp2bs"><code class="xref py py-func docutils literal notranslate"><span class="pre">lp2bs</span></code></a></p></td>
<td><p><span class="math notranslate nohighlight">\(s \rightarrow \frac{s \cdot \mathrm{BW}}{s^2 + {\omega_0}^2}\)</span></p></td>
</tr>
</tbody>
</table>
<p>Here, <span class="math notranslate nohighlight">\(\omega_0\)</span> is the new cutoff or center frequency, and
<span class="math notranslate nohighlight">\(\mathrm{BW}\)</span> is the bandwidth.  These preserve symmetry on a logarithmic
frequency axis.</p>
<p>To convert the transformed analog filter into a digital filter, the
<a class="reference internal" href="../reference/generated/scipy.signal.bilinear.html#scipy.signal.bilinear" title="scipy.signal.bilinear"><code class="xref py py-func docutils literal notranslate"><span class="pre">bilinear</span></code></a> transform is used, which makes the following substitution:</p>
<div class="math notranslate nohighlight">
\[s \rightarrow \frac{2}{T} \frac{z - 1}{z + 1},\]</div>
<p>where T is the sampling time (the inverse of the sampling frequency).</p>
</section>
</section>
<section id="other-filters">
<h3>Other filters<a class="headerlink" href="#other-filters" title="Permalink to this heading">#</a></h3>
<p>The signal processing package provides many more filters as well.</p>
<section id="median-filter">
<h4>Median Filter<a class="headerlink" href="#median-filter" title="Permalink to this heading">#</a></h4>
<p>A median filter is commonly applied when noise is markedly non-Gaussian or
when it is desired to preserve edges. The median filter works by sorting all
of the array pixel values in a rectangular region surrounding the point of
interest. The sample median of this list of neighborhood pixel values is used
as the value for the output array. The sample median is the middle-array value
in a sorted list of neighborhood values. If there are an even number of
elements in the neighborhood, then the average of the middle two values is
used as the median. A general purpose median filter that works on
N-D arrays is <a class="reference internal" href="../reference/generated/scipy.signal.medfilt.html#scipy.signal.medfilt" title="scipy.signal.medfilt"><code class="xref py py-func docutils literal notranslate"><span class="pre">medfilt</span></code></a>. A specialized version that works
only for 2-D arrays is available as <a class="reference internal" href="../reference/generated/scipy.signal.medfilt2d.html#scipy.signal.medfilt2d" title="scipy.signal.medfilt2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">medfilt2d</span></code></a>.</p>
</section>
<section id="order-filter">
<h4>Order Filter<a class="headerlink" href="#order-filter" title="Permalink to this heading">#</a></h4>
<p>A median filter is a specific example of a more general class of filters
called order filters. To compute the output at a particular pixel, all order
filters use the array values in a region surrounding that pixel. These array
values are sorted and then one of them is selected as the output value. For
the median filter, the sample median of the list of array values is used as
the output. A general-order filter allows the user to select which of the
sorted values will be used as the output. So, for example, one could choose to
pick the maximum in the list or the minimum. The order filter takes an
additional argument besides the input array and the region mask that specifies
which of the elements in the sorted list of neighbor array values should be
used as the output. The command to perform an order filter is
<a class="reference internal" href="../reference/generated/scipy.signal.order_filter.html#scipy.signal.order_filter" title="scipy.signal.order_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">order_filter</span></code></a>.</p>
</section>
<section id="wiener-filter">
<h4>Wiener filter<a class="headerlink" href="#wiener-filter" title="Permalink to this heading">#</a></h4>
<p>The Wiener filter is a simple deblurring filter for denoising images. This is
not the Wiener filter commonly described in image-reconstruction problems but,
instead, it is a simple, local-mean filter. Let <span class="math notranslate nohighlight">\(x\)</span> be the input signal,
then the output is</p>
<div class="math notranslate nohighlight">
\[\begin{split}y=\left\{ \begin{array}{cc} \frac{\sigma^{2}}{\sigma_{x}^{2}}m_{x}+\left(1-\frac{\sigma^{2}}{\sigma_{x}^{2}}\right)x &amp; \sigma_{x}^{2}\geq\sigma^{2},\\ m_{x} &amp; \sigma_{x}^{2}&lt;\sigma^{2},\end{array}\right.\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(m_{x}\)</span> is the local estimate of the mean and
<span class="math notranslate nohighlight">\(\sigma_{x}^{2}\)</span> is the local estimate of the variance. The window for
these estimates is an optional input parameter (default is <span class="math notranslate nohighlight">\(3\times3\)</span> ).
The parameter <span class="math notranslate nohighlight">\(\sigma^{2}\)</span> is a threshold noise parameter. If
<span class="math notranslate nohighlight">\(\sigma\)</span> is not given, then it is estimated as the average of the local
variances.</p>
</section>
<section id="hilbert-filter">
<h4>Hilbert filter<a class="headerlink" href="#hilbert-filter" title="Permalink to this heading">#</a></h4>
<p>The Hilbert transform constructs the complex-valued analytic signal
from a real signal. For example, if <span class="math notranslate nohighlight">\(x=\cos\omega n\)</span>, then
<span class="math notranslate nohighlight">\(y=\textrm{hilbert}\left(x\right)\)</span> would return (except near the
edges) <span class="math notranslate nohighlight">\(y=\exp\left(j\omega n\right).\)</span> In the frequency domain,
the hilbert transform performs</p>
<div class="math notranslate nohighlight">
\[Y=X\cdot H,\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is <span class="math notranslate nohighlight">\(2\)</span> for positive frequencies, <span class="math notranslate nohighlight">\(0\)</span> for negative
frequencies, and <span class="math notranslate nohighlight">\(1\)</span> for zero-frequencies.</p>
</section>
</section>
<section id="analog-filter-design">
<h3>Analog Filter Design<a class="headerlink" href="#analog-filter-design" title="Permalink to this heading">#</a></h3>
<p>The functions <a class="reference internal" href="../reference/generated/scipy.signal.iirdesign.html#scipy.signal.iirdesign" title="scipy.signal.iirdesign"><code class="xref py py-func docutils literal notranslate"><span class="pre">iirdesign</span></code></a>, <a class="reference internal" href="../reference/generated/scipy.signal.iirfilter.html#scipy.signal.iirfilter" title="scipy.signal.iirfilter"><code class="xref py py-func docutils literal notranslate"><span class="pre">iirfilter</span></code></a>, and the filter design
functions for specific filter types (e.g., <a class="reference internal" href="../reference/generated/scipy.signal.ellip.html#scipy.signal.ellip" title="scipy.signal.ellip"><code class="xref py py-func docutils literal notranslate"><span class="pre">ellip</span></code></a>) all have a flag
<em class="xref py py-obj">analog</em>, which allows the design of analog filters as well.</p>
<p>The example below designs an analog (IIR) filter, obtains via <a class="reference internal" href="../reference/generated/scipy.signal.tf2zpk.html#scipy.signal.tf2zpk" title="scipy.signal.tf2zpk"><code class="xref py py-func docutils literal notranslate"><span class="pre">tf2zpk</span></code></a>
the poles and zeros and plots them in the complex s-plane. The zeros at
<span class="math notranslate nohighlight">\(\omega \approx 150\)</span> and <span class="math notranslate nohighlight">\(\omega \approx 300\)</span> can be clearly seen
in the amplitude response.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">iirdesign</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="mf">40.</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Analog filter frequency response&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude Response [dB]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="&quot;This code displays two plots. The first plot is an IIR filter response as an X-Y plot with amplitude response on the Y axis vs frequency on the X axis. The low-pass filter shown has a passband from 0 to 100 Hz with 0 dB response and a stop-band from about 175 Hz to 1 KHz about 40 dB down. There are two sharp discontinuities in the filter near 175 Hz and 300 Hz. The second plot is an X-Y showing the transfer function in the complex plane. The Y axis is real-valued an the X axis is complex-valued. The filter has four zeros near [300+0j, 175+0j, -175+0j, -300+0j] shown as blue X markers. The filter also has four poles near [50-30j, -50-30j, 100-8j, -100-8j] shown as red dots.&quot;" class="plot-directive" src="../_images/signal-7_00_00.png" />
</figure>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2zpk</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;xr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;Poles&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Pole / Zero Plot&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Imaginary&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="&quot;This code displays two plots. The first plot is an IIR filter response as an X-Y plot with amplitude response on the Y axis vs frequency on the X axis. The low-pass filter shown has a passband from 0 to 100 Hz with 0 dB response and a stop-band from about 175 Hz to 1 KHz about 40 dB down. There are two sharp discontinuities in the filter near 175 Hz and 300 Hz. The second plot is an X-Y showing the transfer function in the complex plane. The Y axis is real-valued an the X axis is complex-valued. The filter has four zeros near [300+0j, 175+0j, -175+0j, -300+0j] shown as blue X markers. The filter also has four poles near [50-30j, -50-30j, 100-8j, -100-8j] shown as red dots.&quot;" class="plot-directive" src="../_images/signal-7_01_00.png" />
</figure>
</section>
</section>
<section id="spectral-analysis">
<h2>Spectral Analysis<a class="headerlink" href="#spectral-analysis" title="Permalink to this heading">#</a></h2>
<section id="periodogram-measurements">
<h3>Periodogram Measurements<a class="headerlink" href="#periodogram-measurements" title="Permalink to this heading">#</a></h3>
<p>The scipy function <a class="reference internal" href="../reference/generated/scipy.signal.periodogram.html#scipy.signal.periodogram" title="scipy.signal.periodogram"><code class="xref py py-func docutils literal notranslate"><span class="pre">periodogram</span></code></a> provides a method to estimate the
spectral density using the periodogram method.</p>
<p>The example below calculates the periodogram of a sine signal in white
Gaussian noise.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="mf">10e3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="mf">1270.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise_power</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">amp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">time</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">noise_power</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">Pper_spec</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pper_spec</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency [Hz]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="&quot;This code displays a single X-Y log-linear plot with the power spectral density on the Y axis vs frequency on the X axis. A single blue trace shows a noise floor with a power level of 1e-3 with a single peak at 1270 Hz up to a power of 1. The noise floor measurements appear noisy and oscillate down to 1e-7.&quot;" class="plot-directive" src="../_images/signal-8.png" />
</figure>
</section>
<section id="spectral-analysis-using-welch-s-method">
<h3>Spectral Analysis using Welch’s Method<a class="headerlink" href="#spectral-analysis-using-welch-s-method" title="Permalink to this heading">#</a></h3>
<p>An improved method, especially with respect to noise immunity, is Welch’s
method, which is implemented by the scipy function <a class="reference internal" href="../reference/generated/scipy.signal.welch.html#scipy.signal.welch" title="scipy.signal.welch"><code class="xref py py-func docutils literal notranslate"><span class="pre">welch</span></code></a>.</p>
<p>The example below estimates the spectrum using Welch’s method and uses the
same parameters as the example above. Note the much smoother noise floor of
the spectrogram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="mf">10e3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="mf">1270.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise_power</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">amp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">time</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">noise_power</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">Pwelch_spec</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pwelch_spec</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency [Hz]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="&quot;This code displays a single X-Y log-linear plot with the power spectral density on the Y axis vs frequency on the X axis. A single blue trace shows a smooth noise floor at a power level of 6e-2 with a single peak up to a power level of 2 at 1270 Hz.&quot;" class="plot-directive" src="../_images/signal-9.png" />
</figure>
</section>
<section id="lomb-scargle-periodograms-lombscargle">
<h3>Lomb-Scargle Periodograms (<a class="reference internal" href="../reference/generated/scipy.signal.lombscargle.html#scipy.signal.lombscargle" title="scipy.signal.lombscargle"><code class="xref py py-func docutils literal notranslate"><span class="pre">lombscargle</span></code></a>)<a class="headerlink" href="#lomb-scargle-periodograms-lombscargle" title="Permalink to this heading">#</a></h3>
<p>Least-squares spectral analysis (LSSA) <a class="footnote-reference brackets" href="#id4" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> <a class="footnote-reference brackets" href="#id5" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> is a method of estimating a frequency
spectrum, based on a least-squares fit of sinusoids to data samples, similar
to Fourier analysis. Fourier analysis, the most used spectral method in
science, generally boosts long-periodic noise in long-gapped records; LSSA
mitigates such problems.</p>
<p>The Lomb-Scargle method performs spectral analysis on unevenly-sampled data and
is known to be a powerful way to find, and test the significance of, weak
periodic signals.</p>
<p>For a time series comprising <span class="math notranslate nohighlight">\(N_{t}\)</span> measurements <span class="math notranslate nohighlight">\(X_{j}\equiv
X(t_{j})\)</span> sampled at times <span class="math notranslate nohighlight">\(t_{j}\)</span>, where <span class="math notranslate nohighlight">\((j = 1, \ldots, N_{t})\)</span>,
assumed to have been scaled and shifted, such that its mean is zero and its
variance is unity, the normalized Lomb-Scargle periodogram at frequency
<span class="math notranslate nohighlight">\(f\)</span> is</p>
<div class="math notranslate nohighlight">
\[P_{n}(f) \frac{1}{2}\left\{\frac{\left[\sum_{j}^{N_{t}}X_{j}\cos\omega(t_{j}-\tau)\right]^{2}}{\sum_{j}^{N_{t}}\cos^{2}\omega(t_{j}-\tau)}+\frac{\left[\sum_{j}^{N_{t}}X_{j}\sin\omega(t_{j}-\tau)\right]^{2}}{\sum_{j}^{N_{t}}\sin^{2}\omega(t_{j}-\tau)}\right\}.\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\omega \equiv 2\pi f\)</span> is the angular frequency. The frequency-dependent
time offset <span class="math notranslate nohighlight">\(\tau\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\tan 2\omega\tau = \frac{\sum_{j}^{N_{t}}\sin 2\omega t_{j}}{\sum_{j}^{N_{t}}\cos 2\omega t_{j}}.\]</div>
<p>The <a class="reference internal" href="../reference/generated/scipy.signal.lombscargle.html#scipy.signal.lombscargle" title="scipy.signal.lombscargle"><code class="xref py py-func docutils literal notranslate"><span class="pre">lombscargle</span></code></a> function calculates the periodogram using a slightly
modified algorithm due to Townsend <a class="footnote-reference brackets" href="#id6" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>, which allows the periodogram to be
calculated using only a single pass through the input arrays for each
frequency.</p>
<p>The equation is refactored as:</p>
<div class="math notranslate nohighlight">
\[P_{n}(f) = \frac{1}{2}\left[\frac{(c_{\tau}XC + s_{\tau}XS)^{2}}{c_{\tau}^{2}CC + 2c_{\tau}s_{\tau}CS + s_{\tau}^{2}SS} + \frac{(c_{\tau}XS - s_{\tau}XC)^{2}}{c_{\tau}^{2}SS - 2c_{\tau}s_{\tau}CS + s_{\tau}^{2}CC}\right]\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\tan 2\omega\tau = \frac{2CS}{CC-SS}.\]</div>
<p>Here,</p>
<div class="math notranslate nohighlight">
\[c_{\tau} = \cos\omega\tau,\qquad s_{\tau} = \sin\omega\tau,\]</div>
<p>while the sums are</p>
<div class="math notranslate nohighlight">
\[\begin{split}XC &amp;= \sum_{j}^{N_{t}} X_{j}\cos\omega t_{j}\\
XS &amp;= \sum_{j}^{N_{t}} X_{j}\sin\omega t_{j}\\
CC &amp;= \sum_{j}^{N_{t}} \cos^{2}\omega t_{j}\\
SS &amp;= \sum_{j}^{N_{t}} \sin^{2}\omega t_{j}\\
CS &amp;= \sum_{j}^{N_{t}} \cos\omega t_{j}\sin\omega t_{j}.\end{split}\]</div>
<p>This requires <span class="math notranslate nohighlight">\(N_{f}(2N_{t}+3)\)</span> trigonometric function evaluations
giving a factor of <span class="math notranslate nohighlight">\(\sim 2\)</span> speed increase over the straightforward
implementation.</p>
</section>
</section>
<section id="detrend">
<h2>Detrend<a class="headerlink" href="#detrend" title="Permalink to this heading">#</a></h2>
<p>SciPy provides the function <a class="reference internal" href="../reference/generated/scipy.signal.detrend.html#scipy.signal.detrend" title="scipy.signal.detrend"><code class="xref py py-func docutils literal notranslate"><span class="pre">detrend</span></code></a> to remove a constant or linear
trend in a data series in order to see effect of higher order.</p>
<p>The example below removes the constant and linear trend of a second-order
polynomial time series and plots the remaining signal components.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="mf">0.01</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yconst</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ylin</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">yconst</span><span class="p">,</span> <span class="s1">&#39;-bo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ylin</span><span class="p">,</span> <span class="s1">&#39;-k+&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;signal&#39;</span><span class="p">,</span> <span class="s1">&#39;const. detrend&#39;</span><span class="p">,</span> <span class="s1">&#39;linear detrend&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="&quot;This code generates an X-Y plot with no units. A red trace corresponding to the original signal curves from the bottom left to the top right. A blue trace has the constant detrend applied and is below the red trace with zero Y offset. The last black trace has the linear detrend applied and is almost flat from left to right highlighting the curve of the original signal. This last trace has an average slope of zero and looks very different.&quot;" class="plot-directive" src="../_images/signal-10.png" />
</figure>
<p class="rubric">References</p>
<p>Some further reading and related software:</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>N.R. Lomb “Least-squares frequency analysis of unequally spaced
data”, Astrophysics and Space Science, vol 39, pp. 447-462, 1976</p>
</aside>
<aside class="footnote brackets" id="id5" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>J.D. Scargle “Studies in astronomical time series analysis. II -
Statistical aspects of spectral analysis of unevenly spaced data”,
The Astrophysical Journal, vol 263, pp. 835-853, 1982</p>
</aside>
<aside class="footnote brackets" id="id6" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>R.H.D. Townsend, “Fast calculation of the Lomb-Scargle
periodogram using graphics processing units.”, The Astrophysical
Journal Supplement Series, vol 191, pp. 247-253, 2010</p>
</aside>
</aside>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="fft.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Fourier Transforms (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fft</span></code>)</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="linalg.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Linear Algebra (<code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.linalg</span></code>)</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2008-2023, The SciPy community.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>