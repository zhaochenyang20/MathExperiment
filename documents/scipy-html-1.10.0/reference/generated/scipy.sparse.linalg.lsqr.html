


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>scipy.sparse.linalg.lsqr &#8212; SciPy v1.10.0 Manual</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/scipy.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="../../_static/versioncheck.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="scipy.sparse.linalg.lsmr" href="scipy.sparse.linalg.lsmr.html" />
    <link rel="prev" title="scipy.sparse.linalg.tfqmr" href="scipy.sparse.linalg.tfqmr.html" />
    <script defer data-domain="docs.scipy.org" src="https://views.scientific-python.org/js/script.js"></script>
    
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    <img src="../../_static/logo.svg" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/logo.svg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../tutorial/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../dev/index.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../release.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        1.10.0  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables reference/generated/scipy.sparse.linalg.lsqr and {'json_url': 'https://scipy.github.io/devdocs/_static/version_switcher.json', 'version_match': '1.10.0'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "reference/generated/scipy.sparse.linalg.lsqr.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://scipy.github.io/devdocs/_static/version_switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "reference/generated/scipy.sparse.linalg.lsqr.html";
        let btn = document.getElementById("version_switcher_button");
        // Set empty strings by default so that these attributes exist and can be used in CSS selectors
        btn.dataset["activeVersionName"] = "";
        btn.dataset["activeVersion"] = "";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 1.10.0 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "1.10.0") {
                node.classList.add("active");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/scipy/scipy" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/SciPy_team" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../cluster.html">
   Clustering package (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.cluster
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cluster.vq.html">
   K-means clustering and vector quantization (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.cluster.vq
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cluster.hierarchy.html">
   Hierarchical clustering (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.cluster.hierarchy
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../constants.html">
   Constants (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.constants
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets.html">
   Datasets (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.datasets
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fft.html">
   Discrete Fourier transforms (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.fft
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fftpack.html">
   Legacy discrete Fourier transforms (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.fftpack
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../integrate.html">
   Integration and ODEs (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.integrate
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interpolate.html">
   Interpolation (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.interpolate
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../io.html">
   Input and output (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.io
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.html">
   Linear algebra (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.blas.html">
   Low-level BLAS functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg.blas
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.lapack.html">
   Low-level LAPACK functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg.lapack
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.cython_blas.html">
   BLAS Functions for Cython
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.cython_lapack.html">
   LAPACK functions for Cython
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalg.interpolative.html">
   Interpolative matrix decomposition (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.linalg.interpolative
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../misc.html">
   Miscellaneous routines (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.misc
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ndimage.html">
   Multidimensional image processing (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.ndimage
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../odr.html">
   Orthogonal distance regression (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.odr
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../optimize.html">
   Optimization and root finding (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.optimize
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../optimize.cython_optimize.html">
   Cython optimize zeros API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../signal.html">
   Signal processing (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.signal
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sparse.html">
   Sparse matrices (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.sparse
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../sparse.linalg.html">
   Sparse linear algebra (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.sparse.linalg
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sparse.csgraph.html">
   Compressed sparse graph routines (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.sparse.csgraph
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial.html">
   Spatial algorithms and data structures (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.spatial
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../spatial.distance.html">
   Distance computations (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.spatial.distance
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../special.html">
   Special functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.special
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats.html">
   Statistical functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.stats
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats._result_classes.html">
   Result classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats.contingency.html">
   Contingency table functions (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.stats.contingency
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats.mstats.html">
   Statistical functions for masked arrays (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.stats.mstats
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats.qmc.html">
   Quasi-Monte Carlo submodule (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.stats.qmc
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stats.sampling.html">
   Random Number Generators (
   <code class="xref py py-mod docutils literal notranslate">
    <span class="pre">
     scipy.stats.sampling
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ccallback.html">
   Low-level callback functions
  </a>
 </li>
</ul>

    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scipy.sparse.linalg.lsqr">
   <code class="docutils literal notranslate">
    <span class="pre">
     lsqr
    </span>
   </code>
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="scipy-sparse-linalg-lsqr">
<h1>scipy.sparse.linalg.lsqr<a class="headerlink" href="#scipy-sparse-linalg-lsqr" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="scipy.sparse.linalg.lsqr">
<span class="sig-prename descclassname"><span class="pre">scipy.sparse.linalg.</span></span><span class="sig-name descname"><span class="pre">lsqr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">btol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/v1.10.0/scipy/sparse/linalg/_isolve/lsqr.py#L96-L587"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scipy.sparse.linalg.lsqr" title="Permalink to this definition">#</a></dt>
<dd><p>Find the least-squares solution to a large, sparse, linear system
of equations.</p>
<p>The function solves <code class="docutils literal notranslate"><span class="pre">Ax</span> <span class="pre">=</span> <span class="pre">b</span></code>  or  <code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">||Ax</span> <span class="pre">-</span> <span class="pre">b||^2</span></code> or
<code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">||Ax</span> <span class="pre">-</span> <span class="pre">b||^2</span> <span class="pre">+</span> <span class="pre">d^2</span> <span class="pre">||x</span> <span class="pre">-</span> <span class="pre">x0||^2</span></code>.</p>
<p>The matrix A may be square or rectangular (over-determined or
under-determined), and may have any rank.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">Unsymmetric</span> <span class="n">equations</span> <span class="o">--</span>    <span class="n">solve</span>  <span class="n">Ax</span> <span class="o">=</span> <span class="n">b</span>

<span class="mf">2.</span> <span class="n">Linear</span> <span class="n">least</span> <span class="n">squares</span>  <span class="o">--</span>    <span class="n">solve</span>  <span class="n">Ax</span> <span class="o">=</span> <span class="n">b</span>
                               <span class="ow">in</span> <span class="n">the</span> <span class="n">least</span><span class="o">-</span><span class="n">squares</span> <span class="n">sense</span>

<span class="mf">3.</span> <span class="n">Damped</span> <span class="n">least</span> <span class="n">squares</span>  <span class="o">--</span>    <span class="n">solve</span>  <span class="p">(</span>   <span class="n">A</span>    <span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span>    <span class="n">b</span>    <span class="p">)</span>
                                      <span class="p">(</span> <span class="n">damp</span><span class="o">*</span><span class="n">I</span> <span class="p">)</span>     <span class="p">(</span> <span class="n">damp</span><span class="o">*</span><span class="n">x0</span> <span class="p">)</span>
                               <span class="ow">in</span> <span class="n">the</span> <span class="n">least</span><span class="o">-</span><span class="n">squares</span> <span class="n">sense</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>A</strong><span class="classifier">{sparse matrix, ndarray, LinearOperator}</span></dt><dd><p>Representation of an m-by-n matrix.
Alternatively, <code class="docutils literal notranslate"><span class="pre">A</span></code> can be a linear operator which can
produce <code class="docutils literal notranslate"><span class="pre">Ax</span></code> and <code class="docutils literal notranslate"><span class="pre">A^T</span> <span class="pre">x</span></code> using, e.g.,
<code class="docutils literal notranslate"><span class="pre">scipy.sparse.linalg.LinearOperator</span></code>.</p>
</dd>
<dt><strong>b</strong><span class="classifier">array_like, shape (m,)</span></dt><dd><p>Right-hand side vector <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
</dd>
<dt><strong>damp</strong><span class="classifier">float</span></dt><dd><p>Damping coefficient. Default is 0.</p>
</dd>
<dt><strong>atol, btol</strong><span class="classifier">float, optional</span></dt><dd><p>Stopping tolerances. <a class="reference internal" href="#scipy.sparse.linalg.lsqr" title="scipy.sparse.linalg.lsqr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lsqr</span></code></a> continues iterations until a
certain backward error estimate is smaller than some quantity
depending on atol and btol.  Let <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">b</span> <span class="pre">-</span> <span class="pre">Ax</span></code> be the
residual vector for the current approximate solution <code class="docutils literal notranslate"><span class="pre">x</span></code>.
If <code class="docutils literal notranslate"><span class="pre">Ax</span> <span class="pre">=</span> <span class="pre">b</span></code> seems to be consistent, <a class="reference internal" href="#scipy.sparse.linalg.lsqr" title="scipy.sparse.linalg.lsqr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lsqr</span></code></a> terminates
when <code class="docutils literal notranslate"><span class="pre">norm(r)</span> <span class="pre">&lt;=</span> <span class="pre">atol</span> <span class="pre">*</span> <span class="pre">norm(A)</span> <span class="pre">*</span> <span class="pre">norm(x)</span> <span class="pre">+</span> <span class="pre">btol</span> <span class="pre">*</span> <span class="pre">norm(b)</span></code>.
Otherwise, <a class="reference internal" href="#scipy.sparse.linalg.lsqr" title="scipy.sparse.linalg.lsqr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lsqr</span></code></a> terminates when <code class="docutils literal notranslate"><span class="pre">norm(A^H</span> <span class="pre">r)</span> <span class="pre">&lt;=</span>
<span class="pre">atol</span> <span class="pre">*</span> <span class="pre">norm(A)</span> <span class="pre">*</span> <span class="pre">norm(r)</span></code>.  If both tolerances are 1.0e-6 (default),
the final <code class="docutils literal notranslate"><span class="pre">norm(r)</span></code> should be accurate to about 6
digits. (The final <code class="docutils literal notranslate"><span class="pre">x</span></code> will usually have fewer correct digits,
depending on <code class="docutils literal notranslate"><span class="pre">cond(A)</span></code> and the size of LAMBDA.)  If <em class="xref py py-obj">atol</em>
or <em class="xref py py-obj">btol</em> is None, a default value of 1.0e-6 will be used.
Ideally, they should be estimates of the relative error in the
entries of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> respectively.  For example, if the entries
of <code class="docutils literal notranslate"><span class="pre">A</span></code> have 7 correct digits, set <code class="docutils literal notranslate"><span class="pre">atol</span> <span class="pre">=</span> <span class="pre">1e-7</span></code>. This prevents
the algorithm from doing unnecessary work beyond the
uncertainty of the input data.</p>
</dd>
<dt><strong>conlim</strong><span class="classifier">float, optional</span></dt><dd><p>Another stopping tolerance.  lsqr terminates if an estimate of
<code class="docutils literal notranslate"><span class="pre">cond(A)</span></code> exceeds <em class="xref py py-obj">conlim</em>.  For compatible systems <code class="docutils literal notranslate"><span class="pre">Ax</span> <span class="pre">=</span>
<span class="pre">b</span></code>, <em class="xref py py-obj">conlim</em> could be as large as 1.0e+12 (say).  For
least-squares problems, conlim should be less than 1.0e+8.
Maximum precision can be obtained by setting <code class="docutils literal notranslate"><span class="pre">atol</span> <span class="pre">=</span> <span class="pre">btol</span> <span class="pre">=</span>
<span class="pre">conlim</span> <span class="pre">=</span> <span class="pre">zero</span></code>, but the number of iterations may then be
excessive. Default is 1e8.</p>
</dd>
<dt><strong>iter_lim</strong><span class="classifier">int, optional</span></dt><dd><p>Explicit limitation on number of iterations (for safety).</p>
</dd>
<dt><strong>show</strong><span class="classifier">bool, optional</span></dt><dd><p>Display an iteration log. Default is False.</p>
</dd>
<dt><strong>calc_var</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to estimate diagonals of <code class="docutils literal notranslate"><span class="pre">(A'A</span> <span class="pre">+</span> <span class="pre">damp^2*I)^{-1}</span></code>.</p>
</dd>
<dt><strong>x0</strong><span class="classifier">array_like, shape (n,), optional</span></dt><dd><p>Initial guess of x, if None zeros are used. Default is None.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.0.0.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>x</strong><span class="classifier">ndarray of float</span></dt><dd><p>The final solution.</p>
</dd>
<dt><strong>istop</strong><span class="classifier">int</span></dt><dd><p>Gives the reason for termination.
1 means x is an approximate solution to Ax = b.
2 means x approximately solves the least-squares problem.</p>
</dd>
<dt><strong>itn</strong><span class="classifier">int</span></dt><dd><p>Iteration number upon termination.</p>
</dd>
<dt><strong>r1norm</strong><span class="classifier">float</span></dt><dd><p><code class="docutils literal notranslate"><span class="pre">norm(r)</span></code>, where <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">b</span> <span class="pre">-</span> <span class="pre">Ax</span></code>.</p>
</dd>
<dt><strong>r2norm</strong><span class="classifier">float</span></dt><dd><p><code class="docutils literal notranslate"><span class="pre">sqrt(</span> <span class="pre">norm(r)^2</span>&#160; <span class="pre">+</span>&#160; <span class="pre">damp^2</span> <span class="pre">*</span> <span class="pre">norm(x</span> <span class="pre">-</span> <span class="pre">x0)^2</span> <span class="pre">)</span></code>.  Equal to <em class="xref py py-obj">r1norm</em>
if <code class="docutils literal notranslate"><span class="pre">damp</span> <span class="pre">==</span> <span class="pre">0</span></code>.</p>
</dd>
<dt><strong>anorm</strong><span class="classifier">float</span></dt><dd><p>Estimate of Frobenius norm of <code class="docutils literal notranslate"><span class="pre">Abar</span> <span class="pre">=</span> <span class="pre">[[A];</span> <span class="pre">[damp*I]]</span></code>.</p>
</dd>
<dt><strong>acond</strong><span class="classifier">float</span></dt><dd><p>Estimate of <code class="docutils literal notranslate"><span class="pre">cond(Abar)</span></code>.</p>
</dd>
<dt><strong>arnorm</strong><span class="classifier">float</span></dt><dd><p>Estimate of <code class="docutils literal notranslate"><span class="pre">norm(A'&#64;r</span> <span class="pre">-</span> <span class="pre">damp^2*(x</span> <span class="pre">-</span> <span class="pre">x0))</span></code>.</p>
</dd>
<dt><strong>xnorm</strong><span class="classifier">float</span></dt><dd><p><code class="docutils literal notranslate"><span class="pre">norm(x)</span></code></p>
</dd>
<dt><strong>var</strong><span class="classifier">ndarray of float</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">calc_var</span></code> is True, estimates all diagonals of
<code class="docutils literal notranslate"><span class="pre">(A'A)^{-1}</span></code> (if <code class="docutils literal notranslate"><span class="pre">damp</span> <span class="pre">==</span> <span class="pre">0</span></code>) or more generally <code class="docutils literal notranslate"><span class="pre">(A'A</span> <span class="pre">+</span>
<span class="pre">damp^2*I)^{-1}</span></code>.  This is well defined if A has full column
rank or <code class="docutils literal notranslate"><span class="pre">damp</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>.  (Not sure what var means if <code class="docutils literal notranslate"><span class="pre">rank(A)</span>
<span class="pre">&lt;</span> <span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">damp</span> <span class="pre">=</span> <span class="pre">0.</span></code>)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>LSQR uses an iterative method to approximate the solution.  The
number of iterations required to reach a certain accuracy depends
strongly on the scaling of the problem.  Poor scaling of the rows
or columns of A should therefore be avoided where possible.</p>
<p>For example, in problem 1 the solution is unaltered by
row-scaling.  If a row of A is very small or large compared to
the other rows of A, the corresponding row of ( A  b ) should be
scaled up or down.</p>
<p>In problems 1 and 2, the solution x is easily recovered
following column-scaling.  Unless better information is known,
the nonzero columns of A should be scaled so that they all have
the same Euclidean norm (e.g., 1.0).</p>
<p>In problem 3, there is no freedom to re-scale if damp is
nonzero.  However, the value of damp should be assigned only
after attention has been paid to the scaling of A.</p>
<p>The parameter damp is intended to help regularize
ill-conditioned systems, by preventing the true solution from
being very large.  Another aid to regularization is provided by
the parameter acond, which may be used to terminate iterations
before the computed solution becomes very large.</p>
<p>If some initial estimate <code class="docutils literal notranslate"><span class="pre">x0</span></code> is known and if <code class="docutils literal notranslate"><span class="pre">damp</span> <span class="pre">==</span> <span class="pre">0</span></code>,
one could proceed as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Compute a residual vector <code class="docutils literal notranslate"><span class="pre">r0</span> <span class="pre">=</span> <span class="pre">b</span> <span class="pre">-</span> <span class="pre">A&#64;x0</span></code>.</p></li>
<li><p>Use LSQR to solve the system  <code class="docutils literal notranslate"><span class="pre">A&#64;dx</span> <span class="pre">=</span> <span class="pre">r0</span></code>.</p></li>
<li><p>Add the correction dx to obtain a final solution <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">x0</span> <span class="pre">+</span> <span class="pre">dx</span></code>.</p></li>
</ol>
</div></blockquote>
<p>This requires that <code class="docutils literal notranslate"><span class="pre">x0</span></code> be available before and after the call
to LSQR.  To judge the benefits, suppose LSQR takes k1 iterations
to solve A&#64;x = b and k2 iterations to solve <a class="reference external" href="mailto:A&#37;&#52;&#48;dx">A<span>&#64;</span>dx</a> = r0.
If x0 is “good”, norm(r0) will be smaller than norm(b).
If the same stopping tolerances atol and btol are used for each
system, k1 and k2 will be similar, but the final solution x0 + dx
should be more accurate.  The only way to reduce the total work
is to use a larger stopping tolerance for the second system.
If some value btol is suitable for A&#64;x = b, the larger value
btol*norm(b)/norm(r0)  should be suitable for <a class="reference external" href="mailto:A&#37;&#52;&#48;dx">A<span>&#64;</span>dx</a> = r0.</p>
<p>Preconditioning is another way to reduce the number of iterations.
If it is possible to solve a related system <code class="docutils literal notranslate"><span class="pre">M&#64;x</span> <span class="pre">=</span> <span class="pre">b</span></code>
efficiently, where M approximates A in some helpful way (e.g. M -
A has low rank or its elements are small relative to those of A),
LSQR may converge more rapidly on the system <code class="docutils literal notranslate"><span class="pre">A&#64;M(inverse)&#64;z</span> <span class="pre">=</span>
<span class="pre">b</span></code>, after which x can be recovered by solving M&#64;x = z.</p>
<p>If A is symmetric, LSQR should not be used!</p>
<p>Alternatives are the symmetric conjugate-gradient method (cg)
and/or SYMMLQ.  SYMMLQ is an implementation of symmetric cg that
applies to any symmetric A and will converge more rapidly than
LSQR.  If A is positive definite, there are other implementations
of symmetric cg that require slightly less work per iteration than
SYMMLQ (but will take the same number of iterations).</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rffb699be030f-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>C. C. Paige and M. A. Saunders (1982a).
“LSQR: An algorithm for sparse linear equations and
sparse least squares”, ACM TOMS 8(1), 43-71.</p>
</div>
<div class="citation" id="rffb699be030f-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>C. C. Paige and M. A. Saunders (1982b).
“Algorithm 583.  LSQR: Sparse linear equations and least
squares problems”, ACM TOMS 8(2), 195-209.</p>
</div>
<div class="citation" id="rffb699be030f-3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>M. A. Saunders (1995).  “Solution of sparse rectangular
systems using LSQR and CRAIG”, BIT 35, 588-604.</p>
</div>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">csc_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">lsqr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">csc_matrix</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
<p>The first example has the trivial solution <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0]</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">istop</span><span class="p">,</span> <span class="n">itn</span><span class="p">,</span> <span class="n">normr</span> <span class="o">=</span> <span class="n">lsqr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">istop</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">array([ 0.,  0.])</span>
</pre></div>
</div>
<p>The stopping code <em class="xref py py-obj">istop=0</em> returned indicates that a vector of zeros was
found as a solution. The returned solution <em class="xref py py-obj">x</em> indeed contains
<code class="docutils literal notranslate"><span class="pre">[0.,</span> <span class="pre">0.]</span></code>. The next example has a non-trivial solution:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">istop</span><span class="p">,</span> <span class="n">itn</span><span class="p">,</span> <span class="n">r1norm</span> <span class="o">=</span> <span class="n">lsqr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">istop</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">array([ 1., -1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itn</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r1norm</span>
<span class="go">4.440892098500627e-16</span>
</pre></div>
</div>
<p>As indicated by <em class="xref py py-obj">istop=1</em>, <a class="reference internal" href="#scipy.sparse.linalg.lsqr" title="scipy.sparse.linalg.lsqr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lsqr</span></code></a> found a solution obeying the tolerance
limits. The given solution <code class="docutils literal notranslate"><span class="pre">[1.,</span> <span class="pre">-1.]</span></code> obviously solves the equation. The
remaining return values include information about the number of iterations
(<em class="xref py py-obj">itn=1</em>) and the remaining difference of left and right side of the solved
equation.
The final example demonstrates the behavior in the case where there is no
solution for the equation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">istop</span><span class="p">,</span> <span class="n">itn</span><span class="p">,</span> <span class="n">r1norm</span> <span class="o">=</span> <span class="n">lsqr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">istop</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">array([ 1.00333333, -0.99666667])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">b</span>
<span class="go">array([ 0.00333333, -0.00333333,  0.00333333])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r1norm</span>
<span class="go">0.005773502691896255</span>
</pre></div>
</div>
<p><em class="xref py py-obj">istop</em> indicates that the system is inconsistent and thus <em class="xref py py-obj">x</em> is rather an
approximate solution to the corresponding least-squares problem. <em class="xref py py-obj">r1norm</em>
contains the norm of the minimal residual that was found.</p>
</dd></dl>

</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="scipy.sparse.linalg.tfqmr.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">scipy.sparse.linalg.tfqmr</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="scipy.sparse.linalg.lsmr.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">scipy.sparse.linalg.lsmr</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2008-2023, The SciPy community.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>